"use strict";(self.webpackChunkranger=self.webpackChunkranger||[]).push([[665],{5386:(e,t,a)=>{a.d(t,{A:()=>b});var r=a(6540),l=a(8651),n=a(3267),s=a(1376),c=a(2465),o=a(2431),u=a(5615),i=a(2543),d=a(5787),m=a(3666);function p(e,t,a,r,l,n,s){try{var c=e[n](s),o=c.value}catch(e){return void a(e)}c.done?t(o):Promise.resolve(o).then(r,l)}const b=e=>{var[t,a]=(0,r.useState)([]),[b,v]=(0,r.useState)(!0),[y]=(0,l.ok)();(0,r.useEffect)((()=>{e.show&&g()}),[e.show]);var g=function(){var t,r=(t=function*(){var t=[];try{v(!0),t=(yield(0,n.fetchApi)({url:"xusers/authSessions",params:{id:e.data}})).data.vXAuthSessions,a(t),v(!1)}catch(e){v(!1),console.error("Error occurred while fetching Admin logs! ".concat(e))}},function(){var e=this,a=arguments;return new Promise((function(r,l){var n=t.apply(e,a);function s(e){p(n,r,l,s,c,"next",e)}function c(e){p(n,r,l,s,c,"throw",e)}s(void 0)}))});return function(){return r.apply(this,arguments)}}();return r.createElement(c.A,{show:e.show,size:"lg",onHide:e.onHide},r.createElement(c.A.Header,{closeButton:!0},r.createElement(c.A.Title,null,"Session Detail")),r.createElement(c.A.Body,null,b?r.createElement(d.VI,null):r.createElement(o.A,{bordered:!0,hover:!0},r.createElement("tbody",null,r.createElement("tr",null,r.createElement("th",null,"Login ID"),r.createElement("td",null,t.map((e=>e.loginId)))),r.createElement("tr",null,r.createElement("th",null,"Result"),r.createElement("td",null,t.map((e=>{var t="";return Object.keys(s.TD).map((a=>{if(e.authStatus==s.TD[a].value){var r=s.TD[a].label;1==s.TD[a].value||s.TD[a].value,t=r}})),t})))),r.createElement("tr",null,r.createElement("th",null,"Login Type"),r.createElement("td",null,t.map((e=>{var t="";return Object.keys(s.hT).map((a=>{if(e.authType==s.hT[a].value)return t=s.hT[a].label})),t})))),r.createElement("tr",null,r.createElement("th",null,"IP"),r.createElement("td",null,t.map((e=>e.requestIP)))),r.createElement("tr",null,r.createElement("th",null,"User Agent"),r.createElement("td",null,t.map((e=>e.requestUserAgent)))),r.createElement("tr",null,r.createElement("th",null,"Login Time"),r.createElement("td",null,t.map((e=>(0,m.Zq)(e.authTime))))))),r.createElement(u.A,{variant:"link",className:"link-tag",size:"sm",onClick:()=>{e.onHide();var t=Object.fromEntries([...y]);(0,i.has)(t,"sessionId")||e.updateSessionId(e.data)},"data-id":"showAction","data-cy":"showAction"},"Show Actions")),r.createElement(c.A.Footer,null,r.createElement(u.A,{variant:"primary",size:"sm",onClick:e.onHide},"OK")))}},665:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var r=a(6540),l=a(8651),n=a(8106),s=a(6052),c=a(4479),o=a(1105),u=a(9423),i=a(3267),d=a(1376),m=a(5386),p=a(9828),b=a(5787),v=a(4743),y=a.n(v),g=a(2543),h=a(8281),E=a(3666);function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function A(e,t,a,r,l,n,s){try{var c=e[n](s),o=c.value}catch(e){return void a(e)}c.done?t(o):Promise.resolve(o).then(r,l)}const w=function(){var[e,t]=(0,r.useState)([]),[a,v]=(0,r.useState)(!0),[w,T]=(0,r.useState)([]),[k,x]=(0,r.useState)(!1),[D,P]=r.useState(0),[O,I]=(0,r.useState)([]),[N,C]=(0,r.useState)(y().now()),L=(0,r.useRef)(0),[j,H]=(0,r.useState)(!0),[B,q]=(0,r.useState)([]),[U,z]=(0,l.ok)(),[F,M]=(0,r.useState)([]),[J,R]=(0,r.useState)({page:null}),Z=(0,n.Zp)();(0,r.useEffect)((()=>{var{searchFilterParam:e,defaultSearchFilterParam:t,searchParam:a}=(0,E.r8)("loginSession",U,W);z(a,{replace:!0}),JSON.stringify(B)!==JSON.stringify(e)&&q(e),M(t),localStorage.setItem("loginSession",JSON.stringify(a)),H(!1)}),[U]);var K=(0,r.useCallback)(function(){var e,a=(e=function*(e){var{pageSize:a,pageIndex:r,sortBy:l,gotoPage:n}=e;v(!0);var s=[],c=[],o=0,u=++L.current,d=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},B);if(u===L.current){d.pageSize=a,d.startIndex=r*a,l.length>0&&(d.sortBy=(0,E.Cy)(l),d.sortType=(0,E.xi)(l));try{c=(s=yield(0,i.fetchApi)({url:"xusers/authSessions",params:d,skipNavigate:!0})).data.vXAuthSessions,o=s.data.totalCount}catch(e){(0,E.ig)(e),console.error("Error occurred while fetching Login Session logs! ".concat(e))}t(c),I(s.data),P(Math.ceil(o/a)),R({page:n}),v(!1)}},function(){var t=this,a=arguments;return new Promise((function(r,l){var n=e.apply(t,a);function s(e){A(n,r,l,s,c,"next",e)}function c(e){A(n,r,l,s,c,"throw",e)}s(void 0)}))});return function(e){return a.apply(this,arguments)}}(),[N,B]),X=r.useMemo((()=>[{id:"id",desc:!0}]),[]),V=r.useMemo((()=>[{Header:"Session ID",accessor:"id",Cell:e=>{var t=e.value;return null!=t?r.createElement("span",{className:"text-center d-block"},r.createElement("a",{role:"button",className:"text-primary",onClick:()=>{(e=>{x(!0),T(e)})(t)},"data-id":t,"data-cy":t,title:t},t)):r.createElement("span",{className:"text-center d-block"},"--")},width:90},{Header:"Login ID",accessor:"loginId",Cell:e=>e.value?r.createElement("span",{className:"text-center d-block text-truncate"},e.value):r.createElement("span",{className:"text-center d-block"},"--"),width:100,disableSortBy:!0},{Header:"Result",accessor:"authStatus",Cell:e=>{var t="",a="";return Object.keys(d.TD).map((l=>{e.value==d.TD[l].value&&(t=d.TD[l].label,a=1==d.TD[l].value?r.createElement("span",{className:"text-center d-block"},r.createElement(s.A,{bg:"success"},t)):2==d.TD[l].value?r.createElement("span",{className:"text-center d-block"},r.createElement(s.A,{bg:"danger"},t)):r.createElement("span",{className:"text-center d-block"},r.createElement(s.A,{bg:"secondary"},t)))})),a},width:100,disableSortBy:!0},{Header:"Login Type",accessor:"authType",Cell:e=>{var t="";return Object.keys(d.hT).map((a=>{e.value==d.hT[a].value&&(t=d.hT[a].label)})),r.createElement("span",{className:"text-center d-block"},t)},disableSortBy:!0},{Header:"IP",accessor:"requestIP",Cell:e=>e.value?r.createElement("span",{className:"text-truncate text-center d-block",title:e.value},e.value):r.createElement("span",{className:"text-center d-block"},"--"),disableSortBy:!0},{Header:"User Agent",accessor:"requestUserAgent",Cell:e=>e.value?r.createElement("div",{className:"text-truncate",title:e.value},e.value):r.createElement("div",{className:"text-center"},"--"),disableSortBy:!0},{Header:"Login Time ( ".concat((0,E.Zq)()," )"),accessor:"authTime",Cell:e=>{var t=(0,p.Ay)(e.value,"mm/dd/yyyy hh:MM:ss TT");return r.createElement("span",{className:"text-center d-block"},t)},width:180,disableSortBy:!0}]),[]),W=[{category:"endDate",label:"End Date",urlLabel:"endDate",type:"date"},{category:"requestIP",label:"IP",urlLabel:"requestIP",type:"text"},{category:"loginId",label:"Login ID  ",urlLabel:"loginID",type:"text"},{category:"authType",label:"Login Type",urlLabel:"loginType",type:"textoptions",options:()=>[{value:"1",label:"Username/Password"},{value:"2",label:"Kerberos"},{value:"3",label:"SingleSignOn"},{value:"4",label:"Trusted Proxy"}]},{category:"authStatus",label:"Result",urlLabel:"result",type:"textoptions",options:()=>[{value:"1",label:"Success"},{value:"2",label:"Wrong Password"},{value:"3",label:"Account Disabled"},{value:"4",label:"Locked"},{value:"5",label:"Password Expired"},{value:"6",label:"User not found"}]},{category:"id",label:"Session ID",urlLabel:"sessionID",type:"text"},{category:"startDate",label:"Start Date",urlLabel:"startDate",type:"date"},{category:"requestUserAgent",label:"User Agent",urlLabel:"userAgent",type:"text"}];return j?r.createElement(b.aH,null):r.createElement("div",{className:"wrap"},r.createElement(r.Fragment,null,r.createElement(c.A,{className:"mb-2"},r.createElement(o.A,{sm:12},r.createElement("div",{className:"searchbox-border"},r.createElement(h.A,{key:"login-session-search-filter",placeholder:"Search for your login sessions...",options:(0,g.sortBy)(W,["label"]),onChange:e=>{var{searchFilterParam:t,searchParam:a}=(0,E.kI)(e,W);q(t),z(a,{replace:!0}),localStorage.setItem("loginSession",JSON.stringify(a)),"function"==typeof(null==J?void 0:J.page)&&J.page(0)},defaultSelected:F})))),r.createElement(b.IU,{entries:O,refreshTable:()=>{t([]),v(!0),C(y().now())}}),r.createElement(u.A,{data:e,columns:V,fetchData:K,totalCount:O&&O.totalCount,loading:a,pageCount:D,columnSort:!0,defaultSort:X}),r.createElement(m.A,{show:k,data:w,onHide:()=>x(!1),updateSessionId:e=>{Z("/reports/audit/admin?sessionId=".concat(e))}})))}}}]);