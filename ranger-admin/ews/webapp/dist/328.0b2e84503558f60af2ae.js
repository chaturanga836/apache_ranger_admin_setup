"use strict";(self.webpackChunkranger=self.webpackChunkranger||[]).push([[328],{3328:(e,t,a)=>{a.d(t,{A:()=>f,s:()=>A});var l=a(6540),n=a(3267),r=a(4479),c=a(1105),m=a(6052),s=a(2431),i=a(1376),o=a(9828),E=a(6474),d=a(2543),u=a(3666),p=a(5787),y=a(4283);function N(e,t,a,l,n,r,c){try{var m=e[r](c),s=m.value}catch(e){return void a(e)}m.done?t(s):Promise.resolve(s).then(l,n)}function v(e){return function(){var t=this,a=arguments;return new Promise((function(l,n){var r=e.apply(t,a);function c(e){N(r,l,n,c,m,"next",e)}function m(e){N(r,l,n,c,m,"throw",e)}c(void 0)}))}}function A(e){var t,a,N,A,[f,b]=(0,l.useState)([]),[h,x]=(0,l.useState)(!0),[R,_]=(0,l.useState)({}),{updateServices:g}=e,{allServiceDefs:C}=(0,d.cloneDeep)((0,y.Ji)());(0,l.useEffect)((()=>{e.paramsData.isRevert?w():e.paramsData.isChangeVersion?I():T()}),[e.paramsData.isRevert?e.paramsData.isRevert:e.paramsData.version||e.paramsData.policyVersion]);var P,T=function(){var e=v((function*(){yield S()}));return function(){return e.apply(this,arguments)}}(),S=function(){var t=v((function*(){var t,a,l,{policyView:r,paramsData:c}=e,m=r?"":{eventTime:c.eventTime,policyId:c.policyId,versionNo:c.policyVersion};try{a=yield(0,n.fetchApi)({url:r?"plugins/policies/".concat(c.id):"plugins/policies/eventTime",params:m})}catch(e){console.error("eventTime can not be undefined ".concat(e))}l=null==C?void 0:C.find((e=>{var t,l;return e.name==(null===(t=a)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.serviceType)})),b(null===(t=a)||void 0===t?void 0:t.data),_(l),x(!1)}));return function(){return t.apply(this,arguments)}}(),I=function(){var t=v((function*(){var t,a;try{a=yield(0,n.fetchApi)({url:"plugins/policy/".concat(e.paramsData.id||e.paramsData.policyId,"/version/").concat(e.paramsData.version||e.paramsData.policyVersion)})}catch(e){console.error("versionNo can not be undefined ".concat(e))}b(null===(t=a)||void 0===t?void 0:t.data)}));return function(){return t.apply(this,arguments)}}(),w=function(){var t=v((function*(){var t,a,l=e.paramsData.id;try{a=yield(0,n.fetchApi)({url:"plugins/policies/".concat(l),method:"PUT",data:f}),g(),E.oR.success("Policy reverted successfully")}catch(e){console.error("Error occurred while fetching Policy Version or CSRF headers! ".concat(e)),(0,u.ig)(e)}b(null===(t=a)||void 0===t?void 0:t.data)}));return function(){return t.apply(this,arguments)}}(),{service:Y,serviceType:k,policyType:L,id:O,version:D,policyLabels:F,name:G,description:K,resources:M,conditions:z,dataMaskPolicyItems:U,rowFilterPolicyItems:V,policyItems:W,isEnabled:B,allowExceptions:Z,denyPolicyItems:j,denyExceptions:J,isDenyAllElse:X,isAuditEnabled:q,policyPriority:H,updatedBy:Q,updateTime:$,createdBy:ee,createTime:te,validitySchedules:ae,zoneName:le,additionalResources:ne}=f;P=[M,...ne||[]];var re,ce,me,se=(e,t,a,n)=>{var r=[],c=t;return r.push(l.createElement(l.Fragment,null,l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{className:"text-center text-nowrap"},"Select Role "),l.createElement("th",{className:"text-center text-nowrap"},"Select Group "),l.createElement("th",{className:"text-center text-nowrap"},"Select User"),!(0,d.isEmpty)(c&&c.policyConditions)&&l.createElement("th",{className:"text-center text-nowrap"},"Policy Conditions"),l.createElement("th",{className:"text-center text-nowrap"},L==i.Kp.RANGER_ACCESS_POLICY_TYPE.value?"Permissions":"Access Types"),L==i.Kp.RANGER_ACCESS_POLICY_TYPE.value&&"tag"!=a&&l.createElement("th",{className:"text-center text-nowrap"},"Delegate Admin"),L==i.Kp.RANGER_MASKING_POLICY_TYPE.value&&l.createElement("th",{className:"text-center text-nowrap"},"Select Masking Option"),L==i.Kp.RANGER_ROW_FILTER_POLICY_TYPE.value&&l.createElement("th",{className:"text-center text-nowrap"},"Row Level Filter"))))),(0,d.isEmpty)(e)?r.push(l.createElement("tbody",null,l.createElement("tr",null,l.createElement("td",{className:"text-center text-muted",colSpan:6},n)))):e.map(((e,t)=>{return r.push(l.createElement(l.Fragment,null,l.createElement("tbody",null,l.createElement("tr",{key:t},l.createElement("td",{className:"text-center"},(0,d.isEmpty)(e.roles)?"--":e.roles.map((e=>l.createElement(m.A,{bg:"info",className:"text-truncate me-1 more-less-width",key:e},e)))),l.createElement("td",{className:"text-center"},(0,d.isEmpty)(e.groups)?"--":e.groups.map((e=>l.createElement(m.A,{bg:"info",className:"text-truncate me-1 more-less-width",key:e},e)))),l.createElement("td",{className:"text-center"},(0,d.isEmpty)(e.users)?"--":e.users.map((e=>l.createElement(m.A,{bg:"info",key:e,className:"text-truncate me-1 more-less-width "},e)))),!(0,d.isEmpty)(c&&c.policyConditions)&&l.createElement("td",{className:"text-center"},(0,d.isEmpty)(e.conditions)?"--":e.conditions.map(((e,t)=>{var a=c.policyConditions.find((t=>t.name==e.type));return l.createElement("h6",{className:"d-inline me-1",key:t},l.createElement(m.A,{bg:"info",className:"d-inline me-1",key:e.values},"".concat(a.label,": ").concat(e.values.join(", "))))}))),(0,d.isEmpty)(e.accesses)?l.createElement("td",{className:"text-center"},"--"):l.createElement("td",{className:"text-center d-flex flex-wrap policyview-permission-wrap"}," ",e.accesses.map(((e,t)=>l.createElement("h6",{className:"d-inline me-1",key:t},l.createElement(m.A,{bg:"info",className:"d-inline me-1",key:e.type},e.type))))),L==i.Kp.RANGER_ACCESS_POLICY_TYPE.value&&"tag"!=a&&l.createElement("td",{className:"text-center"},l.createElement("input",{type:"checkbox",checked:!1!==e.delegateAdmin,disabled:"disabled"})),L==i.Kp.RANGER_MASKING_POLICY_TYPE.value&&l.createElement("td",{className:"text-center"},(n=e.dataMaskInfo.dataMaskType,s="",c.dataMaskDef.maskTypes.map((e=>e.name==n?s=e.label:"--")),l.createElement("h6",{className:"d-inline me-1"},l.createElement(m.A,{bg:"info"},s)))),L==i.Kp.RANGER_ROW_FILTER_POLICY_TYPE.value&&l.createElement("td",{className:"text-center"},null==e.rowFilterInfo.filterExp?l.createElement("h6",{className:"d-inline me-1"},l.createElement(m.A,{bg:"info"},e.rowFilterInfo.filterExpr)):"--")))));var n,s})),r};return h?l.createElement(p.VI,null):l.createElement(l.Fragment,null,l.createElement("div",null,l.createElement("div",null,l.createElement("p",null,l.createElement("strong",null,"Service Name :")," ",Y)),l.createElement("div",null,l.createElement("p",null,l.createElement("strong",null,"Service Type :")," ",k))),l.createElement("p",{className:"form-header"},"Policy Details :"),l.createElement("div",{className:"overflow-auto"},l.createElement(s.A,{bordered:!0,size:"sm",className:"table-audit-filter-ready-only"},l.createElement("tbody",null,h?l.createElement(p.VI,null):l.createElement(l.Fragment,null,l.createElement("tr",null,l.createElement("td",{className:"text-nowrap"},"Policy Type"),l.createElement("td",null,(me=L)==i.Kp.RANGER_ACCESS_POLICY_TYPE.value?l.createElement("h6",null,l.createElement(m.A,{bg:"primary"},i.Kp.RANGER_ACCESS_POLICY_TYPE.label)):me==i.Kp.RANGER_MASKING_POLICY_TYPE.value?l.createElement("h6",null,l.createElement(m.A,{bg:"primary"},i.Kp.RANGER_MASKING_POLICY_TYPE.label)):me==i.Kp.RANGER_ROW_FILTER_POLICY_TYPE.value?l.createElement("h6",null,l.createElement(m.A,{bg:"primary"},i.Kp.RANGER_ROW_FILTER_POLICY_TYPE.label)):l.createElement("h6",null,l.createElement(m.A,{bg:"primary"},me)))),l.createElement("tr",null,l.createElement("td",{className:"text-nowrap"},"Policy ID"),l.createElement("td",null,l.createElement("h6",{className:"d-inline me-1"},l.createElement(m.A,{bg:"primary"},O)))),l.createElement("tr",null,l.createElement("td",{className:"text-nowrap"},"Version"),l.createElement("td",null,l.createElement("h6",{className:"d-inline me-1"},l.createElement(m.A,{bg:"primary"},D)))),l.createElement("tr",null,l.createElement("td",{className:"text-nowrap"},"Policy Name "),l.createElement("td",{className:"text-break"},(e=>l.createElement(l.Fragment,null,l.createElement("span",{className:"float-start"},e),l.createElement("br",null),l.createElement("div",{className:"text-end"},l.createElement("h6",{className:"d-inline me-1"},l.createElement(m.A,{bg:"dark"},1==H?"Override":"Normal")),l.createElement("h6",{className:"d-inline me-1"},l.createElement(m.A,{bg:"dark"},1==B?"Enabled":"Disabled")))))(G))),l.createElement("tr",null,l.createElement("td",{className:"text-nowrap"},"Policy Labels "),l.createElement("td",{className:"text-break"},(0,d.isEmpty)(F)?"--":F.map(((e,t)=>l.createElement(m.A,{bg:"dark",className:"me-1 more-less-width text-truncate",key:t},e))))),!1,l.createElement("tr",null,l.createElement("td",{className:"text-nowrap"},"Description"),l.createElement("td",{className:"text-break"},(0,d.isEmpty)(K)?"--":K)),l.createElement("tr",null,l.createElement("td",{className:"text-nowrap"},"Audit Logging "),l.createElement("td",null,l.createElement("h6",{className:"d-inline me-1"},l.createElement(m.A,{bg:"info"},1==q?"Yes":"No")))),!(0,d.isEmpty)(le)&&l.createElement("tr",null,l.createElement("td",{className:"text-nowrap"},"Zone Name "),l.createElement("td",{className:"text-break"},l.createElement("h6",{className:"d-inline me-1"},l.createElement(m.A,{bg:"dark"},le)))))))),l.createElement(l.Fragment,null,l.createElement("p",{className:"form-header"},"Policy Resource :"),P&&(0,d.map)(P,((e,t)=>l.createElement(l.Fragment,null,l.createElement(s.A,{bordered:!0,size:"sm",className:"table-audit-filter-ready-only",key:t},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{className:"text-start",colSpan:2},"#",t+1))),l.createElement("tbody",null,((e,t)=>{var a=[],n=R,s=(0,u._b)(n,e);for(var o in t){var E=(0,d.find)(s,{name:o}),p={};p.label=E&&E.label,p.level=E&&E.level,p.values=t[o].values,E&&E.recursiveSupported&&(p.Rec_Recursive=t[o].isRecursive?i.m5.RecursiveStatus.STATUS_RECURSIVE.label:i.m5.RecursiveStatus.STATUS_NONRECURSIVE.label),E&&E.excludesSupported&&(p.Rec_Exc=t[o].isExcludes?i.m5.ExcludeStatus.STATUS_EXCLUDE.label:i.m5.ExcludeStatus.STATUS_INCLUDE.label),a.push(p)}return l.createElement(l.Fragment,null,(0,d.sortBy)(a,"level").map((e=>l.createElement("tr",{key:e.level},l.createElement("td",null,e.label),l.createElement("td",null,l.createElement(r.A,null,l.createElement(c.A,{md:9,className:"d-flex flex-wrap"},e.values.map(((e,t)=>l.createElement(m.A,{className:"d-inline me-1 text-start",bg:"info",key:t},l.createElement("span",{className:"d-inline me-1 item",key:e},e))))),l.createElement(c.A,{className:"text-end",md:3},l.createElement("h6",{className:"d-inline me-1"},l.createElement(m.A,{bg:"dark text-capitalize"},e.Rec_Exc)),l.createElement("h6",{className:"d-inline me-1"},l.createElement(m.A,{bg:"dark text-capitalize"},e.Rec_Recursive)))))))))})(L,e))))))),(L==i.Kp.RANGER_MASKING_POLICY_TYPE.value||i.Kp.RANGER_ROW_FILTER_POLICY_TYPE.value)&&!(0,d.isEmpty)(ae)&&(ce=(re=ae).map((function(e){return{startTime:e.startTime,endTime:e.endTime,timeZone:e.timeZone}})),!(0,d.isEmpty)(re)&&l.createElement(l.Fragment,null,l.createElement("p",{className:"form-header"},"Validity Period :"),l.createElement(s.A,{bordered:!0,size:"sm",className:"table-audit-filter-ready-only"},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{className:"text-center text-nowrap"},"Start Time"),l.createElement("th",{className:"text-center text-nowrap"},"End Time"),l.createElement("th",{className:"text-center text-nowrap"},"Time zone"))),l.createElement("tbody",null,ce.map(((e,t)=>l.createElement("tr",{key:t},l.createElement("td",{className:"text-center"},(0,d.isEmpty)(e.startTime)?"--":l.createElement("strong",null,e.startTime)),l.createElement("td",{className:"text-center"},(0,d.isEmpty)(e.endTime)?"--":l.createElement("strong",null,e.endTime)),l.createElement("td",{className:"text-center"},(0,d.isEmpty)(e.timeZone)?"--":l.createElement("h6",{className:"d-inline"},l.createElement(m.A,{bg:"info"},e.timeZone)))))))))),((e,t)=>!(0,d.isEmpty)(e)&&l.createElement(l.Fragment,null,l.createElement("p",{className:"form-header"},"Policy Conditions :"),l.createElement("div",{className:"overflow-auto"},l.createElement(s.A,{bordered:!0,size:"sm",className:"table-audit-filter-ready-only"},l.createElement("tbody",null,e.map((e=>{return l.createElement("tr",{key:e.type,colSpan:"2"},l.createElement("td",{width:"40%"},(a=e.type,(n=(0,d.find)(t.policyConditions,{name:a}))&&null!=n&&n.label?n.label:"")),l.createElement("td",{width:"60% text-truncate"},e.values.join(", ")));var a,n})))))))(z,R),L==i.Kp.RANGER_ACCESS_POLICY_TYPE.value&&l.createElement(l.Fragment,null,l.createElement("p",{className:"form-header"},"Allow Conditions :"),l.createElement("div",{className:"overflow-auto"},l.createElement(s.A,{bordered:!0,size:"sm",className:"table-audit-filter-ready-only"},se(W,R,k,' No policy items of "Allow Conditions" are present'))),l.createElement("br",null)),L==i.Kp.RANGER_ACCESS_POLICY_TYPE.value&&"true"==(null==R||null===(t=R.options)||void 0===t?void 0:t.enableDenyAndExceptionsInPolicies)&&l.createElement(l.Fragment,null,l.createElement("p",{className:"form-header"},"Exclude from Allow Conditions :"),l.createElement("div",{className:"overflow-auto"},l.createElement(s.A,{bordered:!0,size:"sm",className:"table-audit-filter-ready-only"},se(Z,R,k,'No policy items of "Exclude from Allow Conditions" are present'))),l.createElement("br",null)),L==i.Kp.RANGER_ACCESS_POLICY_TYPE.value&&"true"==(null==R||null===(a=R.options)||void 0===a?void 0:a.enableDenyAndExceptionsInPolicies)&&l.createElement(l.Fragment,null,l.createElement("b",null,"Deny All Other Accesses :"," ",0==X?l.createElement("h6",{className:"d-inline"},l.createElement(m.A,{bg:"dark"},"FALSE")):l.createElement("h6",{className:"d-inline"},l.createElement(m.A,{bg:"dark"},"TRUE")),l.createElement("br",null)),l.createElement("br",null)),0==X&&L==i.Kp.RANGER_ACCESS_POLICY_TYPE.value&&"true"==(null==R||null===(N=R.options)||void 0===N?void 0:N.enableDenyAndExceptionsInPolicies)&&l.createElement(l.Fragment,null,l.createElement("p",{className:"form-header"},"Deny Conditions :"),l.createElement("div",{className:"overflow-auto"},l.createElement(s.A,{bordered:!0,size:"sm",className:"table-audit-filter-ready-only"},se(j,R,k,' No policy items of "Deny Conditions" are present'))),l.createElement("br",null)),0==X&&L==i.Kp.RANGER_ACCESS_POLICY_TYPE.value&&"true"==(null==R||null===(A=R.options)||void 0===A?void 0:A.enableDenyAndExceptionsInPolicies)&&l.createElement(l.Fragment,null,l.createElement("p",{className:"form-header"},"Exclude from Deny Conditions :"),l.createElement("div",{className:"overflow-auto"},l.createElement(s.A,{bordered:!0,size:"sm",className:"table-audit-filter-ready-only"},se(J,R,k,'No policy items of "Exclude from Deny Conditions" are present')))),L==i.Kp.RANGER_ROW_FILTER_POLICY_TYPE.value&&l.createElement(l.Fragment,null,l.createElement("p",{className:"form-header"},"Row Level Conditions :"),l.createElement("div",{className:"overflow-auto"},l.createElement(s.A,{bordered:!0,size:"sm",className:"table-audit-filter-ready-only"},se(V,R,k,'No policy items of "Row Level Conditions" are present')))),L==i.Kp.RANGER_MASKING_POLICY_TYPE.value&&l.createElement(l.Fragment,null,l.createElement("p",{className:"form-header"},"Masking Conditions :"),l.createElement("div",{className:"overflow-auto"},l.createElement(s.A,{bordered:!0,size:"sm",className:"table-audit-filter-ready-only"},se(U,R,k,' No policy items of "Masking Conditions" are present')))),l.createElement("div",{className:"updateInfo clearfix"},l.createElement("div",{className:"float-start"},l.createElement("p",null,l.createElement("strong",null,"Updated By : ")," ",Q),l.createElement("p",null,l.createElement("strong",null,"Updated On : "),(0,o.Ay)($,"mm/dd/yyyy hh:MM TT "))),l.createElement("div",{className:"float-end"},l.createElement("p",null,l.createElement("strong",null,"Created By : ")," ",ee),l.createElement("p",null,l.createElement("strong",null,"Created On : ")," ",(0,o.Ay)(te,"mm/dd/yyyy hh:MM TT ")))))}const f=A}}]);