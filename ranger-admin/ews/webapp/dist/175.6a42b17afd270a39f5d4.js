"use strict";(self.webpackChunkranger=self.webpackChunkranger||[]).push([[175],{1175:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var r=a(6540),n=a(4479),l=a(1105),o=a(5615),s=a(2465),c=a(9423),i=a(5787),u=a(8106),d=a(8651),m=a(4743),g=a.n(m),p=a(2543),f=a(3267),y=a(6474),h=a(3666),v=a(8281);function E(e,t,a,r,n,l,o){try{var s=e[l](o),c=s.value}catch(e){return void a(e)}s.done?t(c):Promise.resolve(c).then(r,n)}function b(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var l=e.apply(t,a);function o(e){E(l,r,n,o,s,"next",e)}function s(e){E(l,r,n,o,s,"throw",e)}o(void 0)}))}}function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const N=function(){var e=(0,u.Zp)(),{state:t}=(0,u.zy)(),[a,m]=(0,r.useState)([]),[E,w]=(0,r.useState)(!0),[S,N]=(0,r.useState)(!0),[O,k]=(0,r.useState)(0),A=(0,r.useRef)(0),D=(0,r.useRef)([]),[x,R]=(0,r.useState)(!1),[L,C]=(0,r.useState)(g().now()),[j,z]=(0,r.useState)(t&&t.showLastPage?t.addPageData.totalPage:0),[H,F]=(0,r.useState)(t&&t.showLastPage?t.addPageData.totalPage-1:0),[U,I]=(0,r.useState)(t&&t.showLastPage?t.addPageData.pageSize:25),[G,B]=(0,r.useState)({page:0}),[J,M]=(0,r.useState)({totalPage:0,pageRecords:0,pageSize:25}),[V,K]=(0,r.useState)([]),[T,W]=(0,d.ok)(),[X,Y]=(0,r.useState)([]),[Z,_]=(0,r.useState)(!1);(0,r.useEffect)((()=>{var e={},a=[],r=Object.fromEntries([...T]);for(var n in r){var l=(0,p.find)(te,{urlLabel:n});if(!(0,p.isUndefined)(l)){var o=l.category,s=r[n];if("textoptions"==l.type){var c=(0,p.find)(l.options(),{label:s});s=void 0!==c?c.value:s}e[o]=s,a.push({category:o,value:s})}}W(P(P({},r),{}),{replace:!0}),JSON.stringify(V)!==JSON.stringify(e)&&K(e),Y(a),N(!1),localStorage.setItem("newDataAdded",t&&t.showLastPage)}),[T]),(0,r.useEffect)((()=>{"true"==localStorage.getItem("newDataAdded")&&(0,i.r7)(a)}),[O]);var q=(0,r.useCallback)(function(){var e=b((function*(e){var{pageSize:a,pageIndex:r,gotoPage:n}=e;w(!0);var l=[],o=[],s=0,c=t&&t.showLastPage?t.addPageData.totalPage-1:r,i=0,u=++A.current,d=P({},V);if(u===A.current){d.page=c,d.startIndex=t&&t.showLastPage?(t.addPageData.totalPage-1)*a:r*a,d.pageSize=a;try{l=(o=yield(0,f.fetchApi)({url:"roles/lookup/roles",params:d})).data.roles,s=o.data.totalCount,i=Math.ceil(s/a)}catch(e){(0,h.ig)(e),console.error("Error occurred while fetching User list! ".concat(e))}t&&(t.showLastPage=!1),M({totalPage:i,pageRecords:o&&o.data&&o.data.totalCount,pageSize:25}),m(l),k(s),z(i),F(c),I(a),B({page:n}),w(!1)}}));return function(t){return e.apply(this,arguments)}}(),[L,V]),Q=()=>{R((e=>!e))},$=function(){var e=b((function*(){var e=D.current,t="";if(e.length>0){for(var{original:r}of(Q(),e))try{_(!0),yield(0,f.fetchApi)({url:"roles/roles/".concat(r.id),method:"DELETE"}),_(!1)}catch(e){var n,l;_(!1),null!=e&&null!==(n=e.response)&&void 0!==n&&null!==(l=n.data)&&void 0!==l&&l.msgDesc?t+=e.response.data.msgDesc+"\n":t+="Error occurred during deleting Role: ".concat(r.name)+"\n",console.error(t)}t?y.oR.error(t):(y.oR.success("Role deleted successfully!"),(1==a.length||a.length==D.current.length)&&H>0?"function"==typeof(null==G?void 0:G.page)&&G.page(0):C(g().now()))}}));return function(){return e.apply(this,arguments)}}(),ee=r.useMemo((()=>[{Header:"Role Name",accessor:"name",Cell:e=>e.value?r.createElement(d.N_,{style:{maxWidth:"100%",display:"inline-block"},className:"text-truncate ".concat((0,h.Dl)()||(0,h.EH)()?"disabled-link text-secondary":"text-info"),to:"/roles/"+e.row.original.id,title:e.value},e.value):"--"},{Header:"Users",accessor:e=>{var t=(0,p.map)(e.users,"name");return(0,p.isEmpty)(t)?r.createElement("div",{className:"text-center"},"--"):r.createElement(i.LH,{data:t,key:e.id})}},{Header:"Groups",accessor:e=>{var t=(0,p.map)(e.groups,"name");return(0,p.isEmpty)(t)?r.createElement("div",{className:"text-center"},"--"):r.createElement(i.LH,{data:t,key:e.id})}},{Header:"Roles",accessor:e=>{var t=(0,p.map)(e.roles,"name");return(0,p.isEmpty)(t)?r.createElement("div",{className:"text-center"},"--"):r.createElement(i.LH,{data:t,key:e.id})}}]),[]),te=[{category:"groupNamePartial",label:"Group Name",urlLabel:"groupName",type:"text"},{category:"roleNamePartial",label:"Role Name",urlLabel:"roleName",type:"text"},{category:"userNamePartial",label:"User Name",urlLabel:"userName",type:"text"}];return r.createElement("div",{className:"wrap"},S?r.createElement(i.aH,null):r.createElement(r.Fragment,null,r.createElement(i.Yh,{isUiBlock:Z}),r.createElement(n.A,{className:"mb-4"},r.createElement(l.A,{md:8,className:"usr-grp-role-search-width"},r.createElement(v.A,{key:"role-listing-search-filter",placeholder:"Search for your roles...",options:te,onChange:e=>{var{searchFilterParam:t,searchParam:a}=(0,h.kI)(e,te);K(t),W(a,{replace:!0}),"function"==typeof(null==G?void 0:G.page)&&G.page(0)},defaultSelected:X})),(0,h.FV)()&&r.createElement(l.A,{md:4,className:"text-end"},r.createElement(o.A,{variant:"primary",size:"sm",onClick:()=>{e("/roles/create",{state:{tblpageData:J}})},"data-id":"addNewRoles","data-cy":"addNewRoles"},"Add New Role"),r.createElement(o.A,{className:"ms-2",variant:"danger",size:"sm",title:"Delete",onClick:()=>{D.current.length>0?Q():y.oR.warning("Please select atleast one role!!")},"data-id":"deleteUserGroup","data-cy":"deleteUserGroup"},r.createElement("i",{className:"fa-fw fa fa-trash"})))),r.createElement(c.A,{data:a,columns:ee,fetchData:q,totalCount:O,pageCount:j,currentpageIndex:H,currentpageSize:U,pagination:!0,loading:E,rowSelectOp:((0,h.FV)()||(0,h.Xm)())&&{position:"first",selectedRows:D}}),r.createElement(s.A,{show:x,onHide:Q},r.createElement(s.A.Header,{closeButton:!0},r.createElement("span",{className:"text-word-break"},"Are you sure you want to delete the ",1===D.current.length?r.createElement(r.Fragment,null,r.createElement("b",null,'"',D.current[0].original.name,'"')," role ?"):r.createElement(r.Fragment,null,"selected",r.createElement("b",null," ",D.current.length)," roles?"))),r.createElement(s.A.Footer,null,r.createElement(o.A,{variant:"secondary",size:"sm",onClick:Q},"Close"),r.createElement(o.A,{variant:"primary",size:"sm",onClick:()=>{$()}},"OK")))))}}}]);