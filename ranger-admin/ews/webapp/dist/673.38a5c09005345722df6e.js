"use strict";(self.webpackChunkranger=self.webpackChunkranger||[]).push([[673],{1659:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(6540),l=r(8106);function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],{navigator:r}=(0,a.useContext)(l.jb);(0,a.useEffect)((()=>{if(t){var a=r.block((t=>{var r=c(c({},t),{},{retry(){a(),setTimeout((()=>{t.retry()}),0)}});e(r)}));return a}}),[r,e,t])}((0,a.useCallback)((t=>{window.confirm(e)&&t.retry()}),[e]),t)}},3673:(e,t,r)=>{r.r(t),r.d(t,{default:()=>_});var a=r(6540),l=r(4479),n=r(1105),c=r(2431),s=r(475),o=r(5615),m=r(952),i=r(5787),u=r(3088),d=r(924),p=r(8539),E=r(6474),f=r(2543),v=r(3666),b=r(8106),y=r(3267),h=r(1659),g=r(1376);function N(){return N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},N.apply(this,arguments)}function A(e,t,r,a,l,n,c){try{var s=e[n](c),o=s.value}catch(e){return void r(e)}s.done?t(o):Promise.resolve(o).then(a,l)}function O(e){return function(){var t=this,r=arguments;return new Promise((function(a,l){var n=e.apply(t,r);function c(e){A(n,a,l,c,s,"next",e)}function s(e){A(n,a,l,c,s,"throw",e)}c(void 0)}))}}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w={loader:!0,roleInfo:{},selectedUser:[],selectedGroup:[],selectedRole:[],preventUnBlock:!1,blockUI:!1},x=e=>{var{isDirtyField:t,isUnblock:r}=e;return(0,h.A)("Are you sure you want to leave",t&&!r),null};function D(e,t){switch(t.type){case"SET_LOADER":return S(S({},e),{},{loader:t.loader});case"SET_ROLE_DATA":return S(S({},e),{},{roleInfo:t.roleInfo,loader:t.loader});case"SET_SELECTED_USER":return S(S({},e),{},{selectedUser:t.selectedUser});case"SET_SELECTED_ROLE":return S(S({},e),{},{selectedRole:t.selectedRole});case"SET_SELECTED_GROUP":return S(S({},e),{},{selectedGroup:t.selectedGroup});case"SET_PREVENT_ALERT":return S(S({},e),{},{preventUnBlock:t.preventUnBlock});case"SET_BLOCK_UI":return S(S({},e),{},{blockUI:t.blockUI});default:throw new Error}}const _=function(){var e=(0,b.g)(),{state:t}=(0,b.zy)(),h=(0,b.Zp)(),[A,R]=(0,a.useReducer)(D,w),{loader:k,roleInfo:_,selectedUser:I,selectedRole:T,selectedGroup:U,preventUnBlock:P,blockUI:C}=A,j=a.useRef(null);(0,a.useEffect)((()=>{null!=e&&e.roleID?B(e.roleID):R({type:"SET_LOADER",loader:!1})}),[]);var L,B=function(){var e=O((function*(e){var t,a;try{var{fetchApi:l}=yield Promise.resolve().then(r.bind(r,3267));a=yield l({url:"roles/roles/"+e})}catch(e){console.error("Error occurred while fetching Role or CSRF headers! ".concat(e))}R({type:"SET_ROLE_DATA",roleInfo:null===(t=a)||void 0===t?void 0:t.data,loader:!1})}));return function(t){return e.apply(this,arguments)}}(),G=function(){var r=O((function*(r){var a=S(S({},_),r);if(!(0,f.isEmpty)(I)||!(0,f.isEmpty)(U)||!(0,f.isEmpty)(T))return E.oR.dismiss(j.current),j.current=E.oR.warning("Please add selected user/group/roles to there respective table else user/group/roles will not be added.");if(R({type:"SET_PREVENT_ALERT",preventUnBlock:!0}),null!=e&&e.roleID)try{R({type:"SET_BLOCK_UI",blockUI:!0}),yield(0,y.fetchApi)({url:"roles/roles/".concat(e.roleID),method:"put",data:a}),R({type:"SET_BLOCK_UI",blockUI:!1}),E.oR.success("Role updated successfully!!"),h("/users/roletab")}catch(e){R({type:"SET_BLOCK_UI",blockUI:!1}),(0,v.ig)(e),console.error("Error occurred while creating Role! ".concat(e))}else try{R({type:"SET_BLOCK_UI",blockUI:!0}),yield(0,y.fetchApi)({url:"roles/roles",method:"post",data:r});var l={};t&&null!=t&&(l=t.tblpageData,t.tblpageData.pageRecords%t.tblpageData.pageSize==0?l.totalPage=t.tblpageData.totalPage+1:void 0!==l&&(l.totalPage=t.tblpageData.totalPage)),R({type:"SET_BLOCK_UI",blockUI:!1}),E.oR.success("Role created successfully!!"),h("/users/roletab",{state:{showLastPage:!0,addPageData:l}})}catch(e){R({type:"SET_BLOCK_UI",blockUI:!1}),(0,v.ig)(e),console.error("Error occurred while updating Role! ".concat(e))}null!==j.current&&E.oR.dismiss(j.current)}));return function(e){return r.apply(this,arguments)}}(),z=function(){var e=O((function*(e){var t={name:e||"",isVisible:1};return(yield(0,y.fetchApi)({url:"xusers/lookup/users",params:t})).data.vXStrings.map((e=>({label:e.value,value:e.value})))}));return function(t){return e.apply(this,arguments)}}(),V=e=>{R({type:"SET_SELECTED_USER",selectedUser:e})},K=function(){var e=O((function*(e){var t={name:e||"",isVisible:1};return(yield(0,y.fetchApi)({url:"xusers/lookup/groups",params:t})).data.vXStrings.map((e=>({label:e.value,value:e.value})))}));return function(t){return e.apply(this,arguments)}}(),M=e=>{R({type:"SET_SELECTED_GROUP",selectedGroup:e})},F=function(){var e=O((function*(e){var t={roleNamePartial:e||""},r=yield(0,y.fetchApi)({url:"roles/roles",params:t});return(void 0!==_.id?(0,f.filter)(r.data.roles,(function(e){return e.id!==_.id})):r.data.roles).map((e=>({label:e.name,value:e.name})))}));return function(t){return e.apply(this,arguments)}}(),H=e=>{R({type:"SET_SELECTED_ROLE",selectedRole:e})};return a.createElement(a.Fragment,null,a.createElement("div",{className:"header-wraper"},a.createElement("h3",{className:"wrap-header bold"},"Role Detail"),(0,v.zH)(["Roles",e.roleID?"RoleEdit":"RoleCreate"],e.roleID)),k?a.createElement(i.aH,null):a.createElement(m.lV,{onSubmit:G,initialValues:(L={},null!=e&&e.roleID&&Object.keys(_).length>0&&(L.name=_.name,L.description=_.description,L.users=_.users,L.groups=_.groups,L.roles=_.roles),L),validate:e=>{var t={};return e.name?g.hp.NAME_VALIDATION.regexExpressionForName.test(e.name)||(t.name=g.hp.NAME_VALIDATION.nameValidationMessage):t.name="Required",t},mutators:S({},d.A),render:t=>{var{handleSubmit:r,form:{mutators:{push:d}},form:v,submitting:b,invalid:y,errors:g,values:A,dirty:O}=t;return a.createElement("div",{className:"wrap user-role-grp-form"},a.createElement(x,{isDirtyField:O,isUnblock:P}),a.createElement("form",{onSubmit:e=>{r(e)}},a.createElement(m.D0,{name:"name"},(t=>{var{input:r,meta:c}=t;return a.createElement(l.A,{className:"form-group"},a.createElement(n.A,{xs:3},a.createElement("label",{className:"form-label float-end"},"Role Name *")),a.createElement(n.A,{xs:4,className:"position-relative"},a.createElement("input",N({},r,{type:"text",name:"name",placeholder:"Role Name",id:c.error&&c.touched?"isError":"name",className:c.error&&c.touched?"form-control border-danger":"form-control",disabled:!!e.roleID,"data-cy":"name"})),a.createElement("span",{className:"input-box-info-icon"},a.createElement(i.VO,{placement:"right",content:a.createElement("p",{className:"pd-10",style:{fontSize:"small"}},"1. User name should be start with alphabet / numeric / underscore / non-us characters.",a.createElement("br",null),"2. Allowed special character ,._-+/@= and space.",a.createElement("br",null),"3. Name length should be greater than one."),icon:"fa-fw fa fa-info-circle"})),c.error&&c.touched&&a.createElement("span",{className:"invalid-field"},c.error)))})),a.createElement(m.D0,{name:"description"},(e=>{var{input:t}=e;return a.createElement(l.A,{className:"form-group"},a.createElement(n.A,{xs:3},a.createElement("label",{className:"form-label float-end"},"Description")),a.createElement(n.A,{xs:4},a.createElement("textarea",N({},t,{placeholder:"Description",className:"form-control","data-cy":"description"}))))})),a.createElement("div",null,a.createElement("fieldset",null,a.createElement("p",{className:"formHeader"},"Users:")),a.createElement("div",{className:"wrap"},a.createElement(n.A,{sm:"8"},a.createElement(u.ED,{name:"users"},(e=>{var{fields:t}=e;return a.createElement(c.A,{className:"table table-bordered fixed-headertable"},a.createElement("thead",{className:"thead-light"},a.createElement("tr",null,a.createElement("th",{className:"text-center"},"User Name"),a.createElement("th",{className:"text-center"},"Is Role Admin"),a.createElement("th",{className:"text-center"},"Action"))),a.createElement("tbody",null,null==t.value?a.createElement("tr",null,a.createElement("td",{className:"text-center text-muted",colSpan:"3"},"No users found")):t.map(((e,r)=>a.createElement("tr",{key:r},a.createElement("td",{className:"text-center more-less-width text-truncate"},a.createElement("span",{title:t.value[r].name},t.value[r].name)),a.createElement("td",{className:"text-center"},a.createElement(m.D0,{className:"form-control",name:"".concat(e,".isAdmin"),render:e=>{var{input:t}=e;return a.createElement("div",null,a.createElement(s.A.Group,null,a.createElement(s.A.Check,N({},t,{checked:t.value,type:"checkbox","data-js":"isRoleAdmin","data-cy":"isRoleAdmin"}))))}})),a.createElement("td",{className:"text-center"},a.createElement(o.A,{variant:"danger",size:"sm",title:"Remove",onClick:()=>t.remove(r),"data-action":"delete","data-cy":"delete"},a.createElement("i",{className:"fa-fw fa fa-remove"}))))))))})),a.createElement("div",{className:"form-group row"},a.createElement("div",{className:"col-sm-9"},a.createElement(p.A,{value:I,filterOption:e=>{var{data:t}=e;return((e,t)=>{if(t&&t.users){var r=t.users.map((e=>({label:e.name,value:e.name})));return-1===(0,f.findIndex)(r,e)}return-1===(0,f.findIndex)(I,e)})(t,A)},onChange:V,loadOptions:z,defaultOptions:!0,isMulti:!0,"data-name":"usersSelect","data-cy":"usersSelect",styles:i.eB})),a.createElement("div",{className:"col-sm-3"},a.createElement(o.A,{type:"button",className:"btn btn-primary",onClick:()=>(e=>{0==I.length?(E.oR.dismiss(j.current),j.current=E.oR.warning("Please select atleast one user!!")):(I.map((e=>{var{value:t}=e;return{name:t,isAdmin:!1}})).map((t=>{e("users",t)})),R({type:"SET_SELECTED_USER",selectedUser:[]}))})(d),size:"sm","data-name":"usersAddBtn","data-cy":"usersAddBtn"},"Add Users")))))),a.createElement("div",null,a.createElement("fieldset",null,a.createElement("p",{className:"formHeader"},"Groups:")),a.createElement("div",{className:"wrap"},a.createElement(n.A,{sm:"8"},a.createElement(u.ED,{name:"groups"},(e=>{var{fields:t}=e;return a.createElement(c.A,{bordered:!0,className:"table table-bordered fixed-headertable"},a.createElement("thead",{className:"thead-light"},a.createElement("tr",null,a.createElement("th",{className:"text-center"},"Group Name"),a.createElement("th",{className:"text-center"},"Is Role Admin"),a.createElement("th",{className:"etxt-center"},"Action"))),a.createElement("tbody",null,null==t.value?a.createElement("tr",null,a.createElement("td",{className:"text-center text-muted",colSpan:"3"},"No groups found")):t.map(((e,r)=>a.createElement("tr",{key:r},a.createElement("td",{className:"text-center more-less-width text-truncate"},a.createElement("span",{title:t.value[r].name},t.value[r].name)),a.createElement("td",{className:"text-center"},a.createElement(m.D0,{className:"form-control",name:"".concat(e,".isAdmin"),render:e=>{var{input:t}=e;return a.createElement("div",null,a.createElement(s.A.Group,null,a.createElement(s.A.Check,N({},t,{checked:t.value,type:"checkbox","data-js":"isRoleAdmin","data-cy":"isRoleAdmin"}))))}})),a.createElement("td",{className:"text-center"},a.createElement(o.A,{variant:"danger",size:"sm",title:"Remove",onClick:()=>t.remove(r),"data-action":"delete","data-cy":"delete"},a.createElement("i",{className:"fa-fw fa fa-remove"}))))))))})),a.createElement("div",{className:"form-group row"},a.createElement("div",{className:"col-sm-9"},a.createElement(p.A,{value:U,filterOption:e=>{var{data:t}=e;return((e,t)=>{if(t&&t.groups){var r=t.groups.map((e=>({label:e.name,value:e.name})));return-1===(0,f.findIndex)(r,e)}return-1===(0,f.findIndex)(U,e)})(t,A)},onChange:M,loadOptions:K,defaultOptions:!0,isMulti:!0,"data-name":"groupsSelect","data-cy":"groupsSelect",styles:i.eB})),a.createElement("div",{className:"col-sm-3"},a.createElement(o.A,{type:"button",className:"btn btn-primary",onClick:()=>(e=>{0==U.length?(E.oR.dismiss(j.current),j.current=E.oR.warning("Please select atleast one group!!")):(U.map((e=>{var{value:t}=e;return{name:t,isAdmin:!1}})).map((t=>{e("groups",t)})),R({type:"SET_SELECTED_GROUP",selectedGroup:[]}))})(d),size:"sm","data-name":"groupsAddBtn","data-cy":"groupsAddBtn"},"Add Groups")))))),a.createElement("div",null,a.createElement("fieldset",null,a.createElement("p",{className:"formHeader"},"Roles:")),a.createElement("div",{className:"wrap"},a.createElement(n.A,{sm:"8"},a.createElement(u.ED,{name:"roles"},(e=>{var{fields:t}=e;return a.createElement(c.A,{bordered:!0,className:"table table-bordered fixed-headertable"},a.createElement("thead",{className:"thead-light"},a.createElement("tr",null,a.createElement("th",{className:"text-center"},"Role Name"),a.createElement("th",{className:"text-center"},"Is Role Admin"),a.createElement("th",{className:"text-center"},"Action"))),a.createElement("tbody",null,null==t.value?a.createElement("tr",null,a.createElement("td",{className:"text-center text-muted",colSpan:"3"},"No roles found")):t.map(((e,r)=>a.createElement("tr",{key:r},a.createElement("td",{className:"text-center more-less-width text-truncate"},a.createElement("span",{title:t.value[r].name},t.value[r].name)),a.createElement("td",{className:"text-center"},a.createElement(m.D0,{className:"form-control",name:"".concat(e,".isAdmin"),render:e=>{var{input:t}=e;return a.createElement("div",null,a.createElement(s.A.Group,null,a.createElement(s.A.Check,N({},t,{checked:t.value,type:"checkbox","data-js":"isRoleAdmin","data-cy":"isRoleAdmin"}))))}})),a.createElement("td",{className:"text-center"},a.createElement(o.A,{variant:"danger",size:"sm",title:"Remove",onClick:()=>t.remove(r),"data-action":"delete","data-cy":"delete"},a.createElement("i",{className:"fa-fw fa fa-remove"}))))))))})),a.createElement("div",{className:"form-group row"},a.createElement("div",{className:"col-sm-9"},a.createElement(p.A,{value:T,filterOption:e=>{var{data:t}=e;return((e,t)=>{if(t&&t.roles){var r=t.roles.map((e=>({label:e.name,value:e.name})));return-1===(0,f.findIndex)(r,e)}return-1===(0,f.findIndex)(T,e)})(t,A)},onChange:H,loadOptions:F,defaultOptions:!0,isMulti:!0,"data-name":"rolesSelect","data-cy":"rolesSelect",styles:i.eB})),a.createElement("div",{className:"col-sm-3"},a.createElement(o.A,{type:"button",className:"btn btn-primary",onClick:()=>(e=>{0==T.length?(E.oR.dismiss(j.current),j.current=E.oR.warning("Please select atleast one role!!")):(T.map((e=>{var{value:t}=e;return{name:t,isAdmin:!1}})).map((t=>{e("roles",t)})),R({type:"SET_SELECTED_ROLE",selectedRole:[]}))})(d),size:"sm","data-name":"rolesAddBtn","data-cy":"rolesAddBtn",s:!0},"Add Roles")))))),a.createElement("div",{className:"row form-actions"},a.createElement("div",{className:"col-md-9 offset-md-3"},a.createElement(o.A,{variant:"primary",onClick:()=>{if(y){var e=document.getElementById("isError")||document.getElementById(Object.keys(g)[0])||document.querySelector("input[name=".concat(Object.keys(g)[0],"]"))||document.querySelector("input[id=".concat(Object.keys(g)[0],"]"))||document.querySelector('span[className="invalid-field"]');(0,i.Nc)(e)}r(A)},size:"sm",disabled:b,"data-id":"save","data-cy":"save"},"Save"),a.createElement(o.A,{variant:"secondary",type:"button",size:"sm",onClick:()=>{v.reset,R({type:"SET_PREVENT_ALERT",preventUnBlock:!0}),h("/users/roletab")},"data-id":"cancel","data-cy":"cancel"},"Cancel")))))}}),a.createElement(i.Yh,{isUiBlock:C}))}}}]);