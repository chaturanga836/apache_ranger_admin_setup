"use strict";(self.webpackChunkranger=self.webpackChunkranger||[]).push([[839],{9839:(e,t,l)=>{l.r(t),l.d(t,{default:()=>d});var n=l(6540),r=l(7337),a=l(3328),c=l(3267),s=l(6474),m=l(2543),u=l(5787),i=l(8106);function E(e,t,l,n,r,a,c){try{var s=e[a](c),m=s.value}catch(e){return void l(e)}s.done?t(m):Promise.resolve(m).then(n,r)}const d=function(){var e=(0,i.g)(),[t,l]=(0,n.useState)([]),[d,o]=(0,n.useState)(!0);(0,n.useEffect)((()=>{p()}),[]);var p=function(){var t,n=(t=function*(){var t={},n={};try{t=yield(0,c.fetchApi)({url:"assets/accessAudit",params:{eventId:e.eventId}})}catch(e){var r,a;console.error("Error occurred while fetching Access or CSRF headers! ".concat(e)),s.oR.error(null==e||null===(r=e.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.msgDesc)}(0,m.isEmpty)(t)||t.data.vXAccessAudits.map((e=>{n=e})),l(n),o(!1)},function(){var e=this,l=arguments;return new Promise((function(n,r){var a=t.apply(e,l);function c(e){E(a,n,r,c,s,"next",e)}function s(e){E(a,n,r,c,s,"throw",e)}c(void 0)}))});return function(){return n.apply(this,arguments)}}();return n.createElement(n.Fragment,null,d?n.createElement(u.aH,null):n.createElement(n.Fragment,null,n.createElement("h5",{className:"heading-without-wrap"},void 0!==e.eventId?"Ranger â€“ audit log":"Audit Access Log Detail"),n.createElement("div",{className:"wrap"},n.createElement(r.A,{data:t})),void 0!==(null==t?void 0:t.policyId)&&(null==t?void 0:t.policyId)>0&&n.createElement(n.Fragment,null,n.createElement("h5",{className:"heading-without-wrap"},"Policy Details"),n.createElement("div",{className:"wrap"},n.createElement(a.s,{paramsData:t,policyView:!1})))))}},7337:(e,t,l)=>{l.d(t,{A:()=>E});var n=l(6540),r=l(2431),a=l(5615),c=l(9828),s=l(2543),m=l(6474),u=l(1376),i=l(3666);const E=e=>{var{data:t={}}=e,{eventTime:l,eventId:E,accessResult:d,clientIP:o,clusterName:p,action:y,policyId:v,requestUser:f,repoName:h,serviceType:g,serviceTypeDisplayName:A,resourcePath:N,resourceType:w,aclEnforcer:b,policyVersion:T,accessType:$,agentId:C,agentHost:I,eventCount:P,zoneName:k,requestData:D,tags:R}=t,x=e=>(!(0,s.isEmpty)(e)&&m.oR.success("Copied successfully!!"),e);return n.createElement(r.A,{bordered:!0,hover:!0},n.createElement("tbody",null,n.createElement("tr",null,n.createElement("td",null,"Audit ID"),n.createElement("td",null,(0,s.isEmpty)(E)?"--":E)),n.createElement("tr",null,n.createElement("td",null,"Policy ID"),n.createElement("td",null,v>0?v:"--")),n.createElement("tr",null,n.createElement("td",null,"Policy Version"),n.createElement("td",null,T||"--")),n.createElement("tr",null,n.createElement("td",null,"Event Time"),n.createElement("td",null,(0,s.isEmpty)(l)?"--":(0,c.Ay)(l,"mm/dd/yyyy hh:MM:ss TT "))),n.createElement("tr",null,n.createElement("td",null,"Application"),n.createElement("td",null,(0,s.isEmpty)(C)?"--":C)),n.createElement("tr",null,n.createElement("td",null,"User"),n.createElement("td",null,(0,s.isEmpty)(f)?"--":f)),n.createElement("tr",null,n.createElement("td",null,"Service Name "),n.createElement("td",null,(0,s.isEmpty)(h)?"--":h)),n.createElement("tr",null,n.createElement("td",null,"Service Type "),n.createElement("td",null,(0,s.isEmpty)(A)?"--":A)),n.createElement("tr",null,n.createElement("td",null,"Resource Path"),n.createElement("td",null,(0,s.isEmpty)(N)?"--":N)),n.createElement("tr",null,n.createElement("td",null,"Resource Type"),n.createElement("td",null,(0,s.isEmpty)(w)?"--":w)),u._i.includes(g)&&"ranger-acl"===b&&!(0,s.isEmpty)(D)&&n.createElement("tr",null,n.createElement("td",null,(0,i.Ad)(g)),n.createElement("td",null,(0,s.isEmpty)(D)?"--":n.createElement(n.Fragment,null,n.createElement(a.A,{className:"float-end link-tag query-icon btn btn-sm",size:"sm",variant:"link",title:"Copy",onClick:()=>navigator.clipboard.writeText(x(D))},n.createElement("i",{className:"fa-fw fa fa-copy"}," ")),n.createElement("span",null,D)))),u.E1.includes(g)&&"hadoop-acl"===b&&!(0,s.isEmpty)(D)&&n.createElement("tr",null,n.createElement("td",null,(0,i.Ad)(g)),n.createElement("td",null,(0,s.isEmpty)(D)?"--":n.createElement(n.Fragment,null,n.createElement(a.A,{className:"float-end link-tag query-icon btn btn-sm",size:"sm",variant:"link",title:"Copy",onClick:()=>navigator.clipboard.writeText(x(D))},n.createElement("i",{className:"fa-fw fa fa-copy"}," ")),n.createElement("span",null,D)))),n.createElement("tr",null,n.createElement("td",null,"Access Type"),n.createElement("td",null,(0,s.isEmpty)($)?"--":$)),n.createElement("tr",null,n.createElement("td",null,"Permission"),n.createElement("td",null,(0,s.isEmpty)(y)?"--":y)),n.createElement("tr",null,n.createElement("td",null,"Result"),n.createElement("td",null,void 0!==d?1==d?"Allowed":"Denied":"--")),n.createElement("tr",null,n.createElement("td",null,"Access Enforcer"),n.createElement("td",null,(0,s.isEmpty)(b)?"--":b)),n.createElement("tr",null,n.createElement("td",null,"Agent Host Name "),n.createElement("td",null,(0,s.isEmpty)(I)?"--":I)),n.createElement("tr",null,n.createElement("td",null,"Client IP "),n.createElement("td",null,(0,s.isEmpty)(o)?"--":o)),n.createElement("tr",null,n.createElement("td",null,"Cluster Name"),n.createElement("td",null,(0,s.isEmpty)(p)?"--":p)),n.createElement("tr",null,n.createElement("td",null,"Zone Name"),n.createElement("td",null,(0,s.isEmpty)(k)?"--":k)),n.createElement("tr",null,n.createElement("td",null,"Event Count"),n.createElement("td",null,P>0?P:"--")),n.createElement("tr",null,n.createElement("td",null,"Tags"),n.createElement("td",null,(0,s.isEmpty)(R)?"--":JSON.parse(R).map((e=>e.type)).sort().join(", ")))))}},2431:(e,t,l)=>{l.d(t,{A:()=>m});var n=l(6942),r=l.n(n),a=l(6540),c=l(6519),s=l(4848);const m=a.forwardRef((({bsPrefix:e,className:t,striped:l,bordered:n,borderless:a,hover:m,size:u,variant:i,responsive:E,...d},o)=>{const p=(0,c.oU)(e,"table"),y=r()(t,p,i&&`${p}-${i}`,u&&`${p}-${u}`,l&&`${p}-${"string"==typeof l?`striped-${l}`:"striped"}`,n&&`${p}-bordered`,a&&`${p}-borderless`,m&&`${p}-hover`),v=(0,s.jsx)("table",{...d,className:y,ref:o});if(E){let e=`${p}-responsive`;return"string"==typeof E&&(e=`${e}-${E}`),(0,s.jsx)("div",{className:e,children:v})}return v}))}}]);