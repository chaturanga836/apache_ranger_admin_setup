"use strict";(self.webpackChunkranger=self.webpackChunkranger||[]).push([[836],{5836:(e,a,t)=>{t.r(a),t.d(a,{default:()=>k});var r=t(6540),n=t(8106),l=t(8651),o=t(6474),c=t(9423),s=t(5615),i=t(4479),u=t(1105),d=t(2465),E=t(3267),m=t(9828),p=t(4743),v=t.n(p),f=t(2543),y=t(8281),g=t(8539),h=t(3666),A=t(5787),S=t(4699);function w(e,a,t,r,n,l,o){try{var c=e[l](o),s=c.value}catch(e){return void t(e)}c.done?a(s):Promise.resolve(s).then(r,n)}function _(e){return function(){var a=this,t=arguments;return new Promise((function(r,n){var l=e.apply(a,t);function o(e){w(l,r,n,o,c,"next",e)}function c(e){w(l,r,n,o,c,"throw",e)}o(void 0)}))}}function b(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function T(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?b(Object(t),!0).forEach((function(a){O(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function O(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function D(e){return{loader:!0,servicesData:[],services:[],selcServicesData:[],keydata:[],onchangeval:"new"==e.params.kmsManagePage?null:{value:e.params.kmsServiceName,label:e.params.kmsServiceName},deleteshowmodal:!1,editshowmodal:!1,filterdata:null,pagecount:0,kmsservice:{},updatetable:v().now(),currentPageIndex:0,currentPageSize:25,resetPage:{page:0}}}function C(e,a){switch(a.type){case"SET_LOADER":return T(T({},e),{},{loader:a.loader});case"SET_DATA":return T(T({},e),{},{services:a.services,servicesData:a.servicesdata});case"SET_SEL_SERVICE":return T(T({},e),{},{selcServicesData:a.selcservicesData,keydata:a.keydatalist,pagecount:a.pagecount});case"SET_ONCHANGE_SERVICE":return T(T({},e),{},{loader:a.loader,onchangeval:a.onchangeval});case"SET_DELETE_MODAL":return T(T({},e),{},{deleteshowmodal:a.deleteshowmodal,filterdata:a.filterdata});case"SET_DELETE_MODAL_CLOSE":return T(T({},e),{},{deleteshowmodal:a.deleteshowmodal});case"SET_EDIT_MODAL":return T(T({},e),{},{editshowmodal:a.editshowmodal,filterdata:a.filterdata});case"SET_EDIT_MODAL_CLOSE":return T(T({},e),{},{editshowmodal:a.editshowmodal});case"SET_UPDATE_TABLE":return T(T({},e),{},{updatetable:a.updatetable});case"SET_CURRENT_PAGE_INDEX":return T(T({},e),{},{currentPageIndex:a.currentPageIndex});case"SET_CURRENT_PAGE_SIZE":return T(T({},e),{},{currentPageSize:a.currentPageSize});case"SET_RESET_PAGE":return T(T({},e),{},{resetPage:a.resetPage});default:throw new Error}}const k=()=>{var e=(0,n.Zp)(),{state:a}=(0,n.zy)(),t={params:(0,n.g)(),state:a},[p,w]=(0,r.useReducer)(C,t,D),[b,O]=(0,r.useState)([]),[k,P]=(0,l.ok)(),[N,L]=(0,r.useState)([]),[R,I]=(0,r.useState)(0),[x,M]=(0,r.useState)(!1),{loader:j,keydata:K,filterdata:H,onchangeval:z,deleteshowmodal:U,editshowmodal:G,currentPageIndex:B,currentPageSize:V,pagecount:X,updatetable:F,resetPage:Z}=p;(0,r.useEffect)((()=>{var e={},a=[],t=Object.fromEntries([...k]);for(var r in t){var n=(0,f.find)(ae,{urlLabel:r});if(!(0,f.isUndefined)(n)){var l=n.category,o=t[r];if("textoptions"==n.type){var c=(0,f.find)(n.options(),{label:o});o=void 0!==c?c.value:o}e[l]=o,a.push({category:l,value:o})}}P(T(T({},t),{}),{replace:!0}),(0,f.isEmpty)(b)&&(0,f.isEmpty)(e)||JSON.stringify(b)===JSON.stringify(e)||O(e),L(a)}),[k]);var J=function(){var e=_((function*(e){var a,t=null,r={};e&&(r.name=e||""),r.serviceType="kms";try{t=(yield(0,E.fetchApi)({url:"plugins/services",params:r})).data.services}catch(e){var n,l,c="Error occurred while fetching Services!";null!=e&&null!==(n=e.response)&&void 0!==n&&null!==(l=n.data)&&void 0!==l&&l.msgDesc&&(c="Error! ".concat(e.response.data.msgDesc)),o.oR.error(c),console.error("Error occurred while fetching Services! ".concat(e))}return a=t.map((e=>({value:e.name,label:e.name}))),w({type:"SET_DATA",servicesdata:t,services:a}),a}));return function(a){return e.apply(this,arguments)}}(),Y=()=>{w({type:"SET_EDIT_MODAL_CLOSE",editshowmodal:!1})},q=(0,r.useCallback)(_((function*(){var e={};e.name=H||"";try{M(!0),yield(0,E.fetchApi)({url:"/keys/key",method:"PUT",params:{provider:z?z.label:""},data:e}),M(!1),o.oR.success("Success! Key rollover successfully"),w({type:"SET_UPDATE_TABLE",updatetable:v().now()})}catch(e){var a,t;M(!1);var r="Error occurred during editing Key\n";null!=e&&null!==(a=e.response)&&void 0!==a&&null!==(t=a.data)&&void 0!==t&&t.msgDesc&&(r="Error! "+e.response.data.msgDesc+"\n"),o.oR.error(r),console.error("Error occurred during editing Key! ".concat(e))}})),[H]),Q=(0,r.useCallback)(_((function*(){try{M(!0),yield(0,E.fetchApi)({url:"/keys/key/".concat(H),method:"DELETE",params:{provider:z?z.label:""}}),M(!1),o.oR.success("Success! Key deleted successfully"),1==K.length&&B>1?"function"==typeof(null==Z?void 0:Z.page)&&Z.page(0):w({type:"SET_UPDATE_TABLE",updatetable:v().now()})}catch(r){var e,a;M(!1);var t;t=null!=r&&null!==(e=r.response)&&void 0!==e&&null!==(a=e.data)&&void 0!==a&&a.msgDesc?o.oR.error("Error! "+r.response.data.msgDesc+"\n"):"Error occurred during deleting Key\n",console.error(t)}})),[H]),W=()=>{w({type:"SET_DELETE_MODAL_CLOSE",deleteshowmodal:!1})},$=(0,r.useCallback)(function(){var e=_((function*(e){var{pageSize:t,pageIndex:r,gotoPage:n}=e;w({type:"SET_LOADER",loader:!0});var l=[],c=null,s=0,i=r,u=T({},b);u.page=i,u.startIndex=r*t,u.pageSize=t,u.provider=z&&z.label;try{c=(l=yield(0,E.fetchApi)({url:"/keys/keys",params:u})).data.vXKeys,s=l.data.totalCount}catch(e){var d,m,p="Error occurred while fetching Services";null!=e&&null!==(d=e.response)&&void 0!==d&&null!==(m=d.data)&&void 0!==m&&m.msgDesc&&(p="Error! "+e.response.data.msgDesc),o.oR.error(p),console.error("Error occurred while fetching Services! ".concat(e))}a&&(a.showLastPage=!1),w({type:"SET_SEL_SERVICE",keydatalist:c,pagecount:Math.ceil(s/t)}),w({type:"SET_CURRENT_PAGE_INDEX",currentPageIndex:i}),w({type:"SET_CURRENT_PAGE_SIZE",currentPageSize:t}),w({type:"SET_RESET_PAGE",resetPage:{page:n}}),w({type:"SET_LOADER",loader:!1}),I(s)}));return function(a){return e.apply(this,arguments)}}(),[z,F,b]),ee=r.useMemo((()=>[{Header:"Key Name",accessor:"name",Cell:e=>{if(e&&e.value)return r.createElement("p",{className:"text-truncate"},e.value)}},{Header:"Cipher",accessor:"cipher",Cell:e=>{if(e&&e.value)return r.createElement("p",{className:"text-center"},e.value)}},{Header:"Version",accessor:"versions",Cell:e=>{if(e&&e.value)return r.createElement("p",{className:"text-center"},e.value)},width:70},{Header:"Attributes",accessor:"attributes",Cell:e=>{var a="";return e&&e.value&&(a=Object.keys(e.value).map((a=>{if(!(0,f.isEmpty)(a))return r.createElement("p",{className:"text-truncate",key:a},a,r.createElement("i",{className:"fa-fw fa fa-long-arrow-right fa-fw fa fa-3"}),e.value[a],r.createElement("br",null))}))),a}},{Header:"Length",accessor:"length",Cell:e=>{if(e&&e.value)return r.createElement("p",{className:"text-center"},e.value)},width:70},{Header:"Created Date",accessor:"created",Cell:e=>{if(e&&e.value){var a=e.value,t=(0,m.Ay)(a,"mm/dd/yyyy hh:MM:ss TT");return r.createElement("div",{className:"text-center"},t)}}},{Header:"Action",accessor:"action",Cell:e=>r.createElement("div",{className:"text-center"},r.createElement(s.A,{className:"btn btn-outline-dark btn-sm m-r-5",size:"sm",title:"Edit",onClick:()=>{var a;a=e.row.original.name,w({type:"SET_EDIT_MODAL",editshowmodal:!0,filterdata:a})},"data-name":"rolloverKey","data-id":e.row.original.name,"data-cy":e.row.original.name},r.createElement("i",{className:"fa-fw fa fa-edit"})),r.createElement(s.A,{variant:"danger",size:"sm",title:"Delete",onClick:()=>{var a;a=e.row.original.name,w({type:"SET_DELETE_MODAL",deleteshowmodal:!0,filterdata:a})},"data-name":"deleteKey","data-id":e.row.original.name,"data-cy":e.row.original.name},r.createElement("i",{className:"fa-fw fa fa-trash"}))),width:80}]),[F]),ae=[{category:"name",label:"Key Name",urlLabel:"keyName",type:"text"}];return r.createElement("div",null,r.createElement("div",{className:"header-wraper"},r.createElement("h3",{className:"wrap-header bold"},"Key Management"),r.createElement(S.A,null)),r.createElement("div",{className:"wrap"},r.createElement(A.Yh,{isUiBlock:x}),r.createElement(i.A,null,r.createElement(u.A,{sm:12},r.createElement("div",{className:"formHeader pb-3 mb-3"},"Select Service:",r.createElement(g.A,{value:z,className:"w-25",isClearable:!0,components:{IndicatorSeparator:()=>null},onChange:e=>{w({type:"SET_ONCHANGE_SERVICE",onchangeval:e,loader:!1})},loadOptions:J,placeholder:"Please select KMS service",defaultOptions:!0})))),r.createElement(i.A,{className:"mb-2"},r.createElement(u.A,{sm:10},r.createElement(y.A,{key:"key-search-filter",placeholder:"Search for your keys...",options:(0,f.sortBy)(ae,["label"]),onChange:e=>{var{searchFilterParam:a,searchParam:t}=(0,h.kI)(e,ae);O(a),P(t,{replace:!0})},defaultSelected:N})),(0,h.Xm)()&&r.createElement(u.A,{sm:2,className:"text-end"},r.createElement(s.A,{className:null!==z?"":"button-disabled",disabled:null==z,onClick:()=>{e("/kms/keys/".concat(z.label,"/create"),{state:{detail:z.label}})},"data-id":"addNewKey","data-cy":"addNewKey"},"Add New Key"))),r.createElement(c.A,{loading:j,data:K||[],columns:(0,h.Xm)()?ee:(0,f.reject)(ee,["Header","Action"]),fetchData:$,pageCount:X,currentPageIndex:B,currentPageSize:V,totalCount:R}),r.createElement(d.A,{show:G,onHide:Y},r.createElement(d.A.Body,null,"Are you sure want to rollover ?"),r.createElement(d.A.Footer,null,r.createElement(s.A,{variant:"secondary",onClick:Y},"Close"),r.createElement(s.A,{variant:"primary",onClick:()=>{q(),w({type:"SET_EDIT_MODAL_CLOSE",editshowmodal:!1})}},"Ok"))),r.createElement(d.A,{show:U,onHide:W},r.createElement(d.A.Body,null,"Are you sure you want to delete ?"),r.createElement(d.A.Footer,null,r.createElement(s.A,{variant:"secondary",onClick:W},"Close"),r.createElement(s.A,{variant:"primary",onClick:()=>{Q(),w({type:"SET_DELETE_MODAL",deleteshowmodal:!1})}},"Ok")))))}},8539:(e,a,t)=>{t.d(a,{A:()=>s});var r=t(8168),n=t(6540),l=t(8744),o=t(2836),c=t(4977);t(961),t(7003);const s=(0,n.forwardRef)((function(e,a){var t=(0,c.u)(e),s=(0,o.u)(t);return n.createElement(l.S,(0,r.A)({ref:a},s))}))},4977:(e,a,t)=>{t.d(a,{u:()=>u});var r=t(4467),n=t(9379),l=t(296),o=t(45),c=t(6540),s=t(7505),i=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function u(e){var a=e.defaultOptions,t=void 0!==a&&a,u=e.cacheOptions,d=void 0!==u&&u,E=e.loadOptions;e.options;var m=e.isLoading,p=void 0!==m&&m,v=e.onInputChange,f=e.filterOption,y=void 0===f?null:f,g=(0,o.A)(e,i),h=g.inputValue,A=(0,c.useRef)(void 0),S=(0,c.useRef)(!1),w=(0,c.useState)(Array.isArray(t)?t:void 0),_=(0,l.A)(w,2),b=_[0],T=_[1],O=(0,c.useState)(void 0!==h?h:""),D=(0,l.A)(O,2),C=D[0],k=D[1],P=(0,c.useState)(!0===t),N=(0,l.A)(P,2),L=N[0],R=N[1],I=(0,c.useState)(void 0),x=(0,l.A)(I,2),M=x[0],j=x[1],K=(0,c.useState)([]),H=(0,l.A)(K,2),z=H[0],U=H[1],G=(0,c.useState)(!1),B=(0,l.A)(G,2),V=B[0],X=B[1],F=(0,c.useState)({}),Z=(0,l.A)(F,2),J=Z[0],Y=Z[1],q=(0,c.useState)(void 0),Q=(0,l.A)(q,2),W=Q[0],$=Q[1],ee=(0,c.useState)(void 0),ae=(0,l.A)(ee,2),te=ae[0],re=ae[1];d!==te&&(Y({}),re(d)),t!==W&&(T(Array.isArray(t)?t:void 0),$(t)),(0,c.useEffect)((function(){return S.current=!0,function(){S.current=!1}}),[]);var ne=(0,c.useCallback)((function(e,a){if(!E)return a();var t=E(e,a);t&&"function"==typeof t.then&&t.then(a,(function(){return a()}))}),[E]);(0,c.useEffect)((function(){!0===t&&ne(C,(function(e){S.current&&(T(e||[]),R(!!A.current))}))}),[]);var le=(0,c.useCallback)((function(e,a){var t=(0,s.L)(e,a,v);if(!t)return A.current=void 0,k(""),j(""),U([]),R(!1),void X(!1);if(d&&J[t])k(t),j(t),U(J[t]),R(!1),X(!1);else{var l=A.current={};k(t),R(!0),X(!M),ne(t,(function(e){S&&l===A.current&&(A.current=void 0,R(!1),j(t),U(e||[]),X(!1),Y(e?(0,n.A)((0,n.A)({},J),{},(0,r.A)({},t,e)):J))}))}}),[d,ne,M,J,v]),oe=V?[]:C&&M?z:b||[];return(0,n.A)((0,n.A)({},g),{},{options:oe,isLoading:L||p,onInputChange:le,filterOption:y})}}}]);