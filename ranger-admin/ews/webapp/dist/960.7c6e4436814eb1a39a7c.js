"use strict";(self.webpackChunkranger=self.webpackChunkranger||[]).push([[960],{3960:(e,t,a)=>{a.r(t),a.d(t,{default:()=>E});var r=a(6540),l=a(8106),n=a(8651),c=a(6052),s=a(4479),o=a(1105),u=a(9423),i=a(5787),p=a(4743),m=a.n(p),d=a(9828),y=a(2543),g=a(8281),b=a(3267),f=a(3666);function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function h(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function S(e,t,a,r,l,n,c){try{var s=e[n](c),o=s.value}catch(e){return void a(e)}s.done?t(o):Promise.resolve(o).then(r,l)}const E=function(){var e=(0,l.KC)().services,[t,a]=(0,r.useState)([]),[p,E]=(0,r.useState)(!0),[P,x]=r.useState(0),[N,C]=(0,r.useState)([]),[O,k]=(0,r.useState)(m().now()),w=(0,r.useRef)(0),[D,I]=(0,r.useState)(!0),[j,H]=(0,r.useState)([]),[B,A]=(0,n.ok)(),[L,R]=(0,r.useState)([]),[M,F]=(0,r.useState)({page:null}),J=(0,f.Xm)()||(0,f.EH)();(0,r.useEffect)((()=>{var{searchFilterParam:e,defaultSearchFilterParam:t,searchParam:a}=(0,f.r8)("agent",B,q);A(a,{replace:!0}),JSON.stringify(j)!==JSON.stringify(e)&&H(e),R(t),localStorage.setItem("agent",JSON.stringify(a)),I(!1)}),[B]);var T=(0,r.useCallback)(function(){var e,t=(e=function*(e){var{pageSize:t,pageIndex:r,sortBy:l,gotoPage:n}=e;E(!0);var c=[],s=[],o=0,u=++w.current,i=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){h(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},j);if(u===w.current){i.pageSize=t,i.startIndex=r*t,l.length>0&&(i.sortBy=(0,f.Cy)(l),i.sortType=(0,f.xi)(l));try{s=(c=yield(0,b.fetchApi)({url:"assets/exportAudit",params:i,skipNavigate:!0})).data.vXPolicyExportAudits,o=c.data.totalCount}catch(e){(0,f.ig)(e),console.error("Error occurred while fetching Plugins logs! ".concat(e))}a(s),C(c.data),x(Math.ceil(o/t)),F({page:n}),E(!1)}},function(){var t=this,a=arguments;return new Promise((function(r,l){var n=e.apply(t,a);function c(e){S(n,r,l,c,s,"next",e)}function s(e){S(n,r,l,c,s,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),[O,j]),z=r.useMemo((()=>[{Header:"Export Date  ( ".concat((0,f.Zq)()," )"),accessor:"createDate",Cell:e=>{var t=(0,d.Ay)(e.value,"mm/dd/yyyy hh:MM:ss TT");return r.createElement("span",{className:"text-center d-block"},t)},width:240},{Header:"Service Name",accessor:"repositoryName",Cell:e=>e.value?r.createElement("span",{className:"text-truncate text-center d-block",title:e.value},e.value):r.createElement("span",{className:"text-center d-block"},"--"),disableSortBy:!0},{Header:"Plugin ID",accessor:"agentId",Cell:e=>(0,y.isEmpty)(e.value)?r.createElement("span",{className:"text-center d-block"},"--"):r.createElement("span",{className:"text-truncate text-center d-block",title:e.value},e.value),disableSortBy:!0},{Header:"Plugin IP",accessor:"clientIP",Cell:e=>r.createElement("span",{className:"text-truncate text-center d-block",title:e.value},e.value),disableSortBy:!0},{Header:"Cluster Name",accessor:"clusterName",Cell:e=>(0,y.isEmpty)(e.value)?r.createElement("span",{className:"text-center d-block"},"--"):r.createElement("span",{className:"text-truncate text-center d-block",title:e.value},e.value),width:100,disableSortBy:!0},{Header:"Http Response Code",accessor:"httpRetCode",Cell:e=>r.createElement("span",{className:"text-center d-block"},r.createElement(c.A,{bg:"success"},e.value)),disableSortBy:!0},{Header:"Status",accessor:"syncStatus",disableSortBy:!0}]),[]),X=r.useMemo((()=>[{id:"createDate",desc:!0}]),[]),q=[{category:"cluster",label:"Cluster Name",urlLabel:"clusterName",type:"text"},{category:"endDate",label:"End Date",urlLabel:"endDate",type:"date"},{category:"httpRetCode",label:"Http Response Code",urlLabel:"httpResponseCode",type:"text"},{category:"agentId",label:"Plugin ID",urlLabel:"pluginID",type:"text"},{category:"clientIP",label:"Plugin IP",urlLabel:"pluginIP",type:"text"},{category:"repositoryName",label:"Service Name",urlLabel:"serviceName",type:"textoptions",options:()=>{var t,a;return a=(0,y.filter)(e,(function(e){return J?"tag"!==e.type:"tag"!==e.type&&"kms"!==e.type})),null===(t=(0,y.sortBy)(a,"name"))||void 0===t?void 0:t.map((e=>({label:e.name,value:e.name})))}},{category:"startDate",label:"Start Date",urlLabel:"startDate",type:"date"}];return D?r.createElement(i.aH,null):r.createElement("div",{className:"wrap"},r.createElement(r.Fragment,null,r.createElement(s.A,{className:"mb-2"},r.createElement(o.A,{sm:12},r.createElement("div",{className:"searchbox-border"},r.createElement(g.A,{key:"plugin-log-search-filter",placeholder:"Search for your plugins...",options:(0,y.sortBy)(q,["label"]),onChange:e=>{var{searchFilterParam:t,searchParam:a}=(0,f.kI)(e,q);H(t),A(a,{replace:!0}),localStorage.setItem("agent",JSON.stringify(a)),"function"==typeof(null==M?void 0:M.page)&&M.page(0)},defaultSelected:L})))),r.createElement(i.IU,{entries:N,refreshTable:()=>{a([]),E(!0),k(m().now())}}),r.createElement(u.A,{data:t,columns:z,loading:p,totalCount:N&&N.totalCount,fetchData:T,pageCount:P,columnSort:!0,defaultSort:X})))}}}]);