"use strict";(self.webpackChunkranger=self.webpackChunkranger||[]).push([[583],{2885:(e,t,a)=>{a.d(t,{A:()=>r});var l=a(6540),n=a(8106);function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},s.apply(this,arguments)}const r=e=>t=>{var a=(0,n.zy)(),r=(0,n.Zp)(),o=(0,n.g)();return l.createElement(e,s({navigate:r,location:a,params:o},t))}},583:(e,t,a)=>{a.r(t),a.d(t,{default:()=>S});var l=a(6540),n=a(8651),s=a(6474),r=a(3267),o=a(3666),i=a(5615),c=a(2465),m=a(4468),d=a(475),u=a(4479),p=a(1105),h=a(6052),v=a(2431),E=a(2543);function b(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class A extends l.Component{constructor(e){super(e),b(this,"deleteZoneModal",(e=>{this.setState({showDeleteModal:e})})),b(this,"closeZoneModal",(()=>{this.setState({showDeleteModal:null})})),b(this,"deleteZone",(e=>{this.setState({showDeleteModal:null}),this.props.deleteZone(e)})),b(this,"expandbtn",(()=>{this.setState({expand:!0})})),this.state={expand:!0,showDeleteModal:null,isAdminRole:(0,o.FV)()||(0,o.Xm)()},this.expandbtn=this.expandbtn.bind(this),this.closeZoneModal=this.closeZoneModal.bind(this)}render(){var e,t,a,s,r,o,b,A,f,g,N,y,z,w,x,Z,k,S,C,U,B,D,I,R,M,G,j,L,O,F,H,K,P,_,T,V,X,Y,J,q,Q,W,$,ee;return l.createElement("div",{className:"row"},l.createElement("div",{className:"col-sm-12"},l.createElement("div",{className:"d-flex justify-content-between"},l.createElement("div",{className:"float-start d-flex align-items-center"},l.createElement(i.A,{variant:"outline-secondary",size:"sm",className:"btn-slide-toggle m-r-sm pull-left","aria-controls":"example-collapse-text","aria-expanded":this.props.isCollapse,onClick:()=>this.props.expandBtn(this.props.isCollapse),"data-id":"sideBarBtn","data-cy":"sideBarBtn"},l.createElement("i",{className:"fa-fw fa fa-reorder"})),l.createElement("h5",{className:"text-info d-inline zone-name mb-0"},this.props.zone.name)),this.state.isAdminRole&&l.createElement("div",{className:"float-end d-flex align-items-start"},l.createElement(n.N_,{className:"btn btn-sm btn-outline-primary m-r-5",title:"Edit",to:"/zones/edit/".concat(this.props.zone.id),"data-id":"editZone","data-cy":"editZone",style:{whiteSpace:"nowrap"}},l.createElement("i",{className:"fa-fw fa fa-edit"})," Edit"),l.createElement(i.A,{variant:"danger",size:"sm",title:"Delete",onClick:()=>this.deleteZoneModal(this.props.zone.id),"data-id":"deleteZone",style:{whiteSpace:"nowrap"}},l.createElement("i",{className:"fa-fw fa fa-trash"})," Delete"),l.createElement(c.A,{show:this.state.showDeleteModal===this.props.zone.id,onHide:this.closeZoneModal,backdrop:"static"},l.createElement(c.A.Header,{closeButton:!0},l.createElement("span",{className:"text-word-break"},'Are you sure want to delete zoneÂ "',l.createElement("b",null,"".concat(this.props.zone.name)),'" ?')),l.createElement(c.A.Footer,null,l.createElement(i.A,{variant:"secondary",size:"sm",onClick:this.closeZoneModal},"Cancel"),l.createElement(i.A,{variant:"primary",size:"sm",onClick:()=>{this.deleteZone(this.props.zone.id)}},"Yes"))))),l.createElement("br",null),l.createElement("p",{className:"text-break"},this.props.zone.description),l.createElement("div",null,l.createElement(m.A,{defaultActiveKey:"0"},l.createElement(m.A.Item,{eventKey:"0"},l.createElement(m.A.Header,{"data-id":"panel","data-cy":"panel"},"Zone Administrations"),l.createElement(m.A.Body,null,l.createElement(d.A,{className:"border border-white shadow-none p-0"},l.createElement(d.A.Group,{as:u.A,className:"mb-3"},l.createElement(d.A.Label,{className:"text-end",column:!0,sm:"3"},"Admin Users"),l.createElement(p.A,{sm:"9",className:"pt-2"},(null===(e=this.props)||void 0===e||null===(t=e.zone)||void 0===t||null===(a=t.adminUsers)||void 0===a?void 0:a.length)>0?null===(s=this.props)||void 0===s||null===(r=s.zone.adminUsers)||void 0===r?void 0:r.map((e=>l.createElement(h.A,{bg:"info",className:"me-1 more-less-width text-truncate",key:e,title:e},e))):l.createElement("p",{className:"mt-1"},"--"))),l.createElement(d.A.Group,{as:u.A,className:"mb-3"},l.createElement(d.A.Label,{className:"text-end",column:!0,sm:"3"},"Admin Usergroups"),l.createElement(p.A,{sm:"9",className:"pt-2"},(null===(o=this.props)||void 0===o||null===(b=o.zone)||void 0===b||null===(A=b.adminUserGroups)||void 0===A?void 0:A.length)>0?null===(f=this.props)||void 0===f||null===(g=f.zone)||void 0===g||null===(N=g.adminUserGroups)||void 0===N?void 0:N.map((e=>l.createElement(h.A,{bg:"secondary",className:"me-1 more-less-width text-truncate",key:e,title:e},e))):l.createElement("span",{className:"mt-1"},"--"))),l.createElement(d.A.Group,{as:u.A,className:"mb-3"},l.createElement(d.A.Label,{className:"text-end",column:!0,sm:"3"},"Admin Roles"),l.createElement(p.A,{sm:"9",className:"pt-2"},(null===(y=this.props)||void 0===y||null===(z=y.zone)||void 0===z||null===(w=z.adminRoles)||void 0===w?void 0:w.length)>0?null===(x=this.props)||void 0===x||null===(Z=x.zone.adminRoles)||void 0===Z?void 0:Z.map((e=>l.createElement(h.A,{bg:"primary",className:"me-1 more-less-width text-truncate",key:e,title:e},e))):l.createElement("p",{className:"mt-1"},"--"))),l.createElement(d.A.Group,{as:u.A,className:"mb-3"},l.createElement(d.A.Label,{className:"text-end",column:!0,sm:"3"},"Auditor Users"),l.createElement(p.A,{sm:"9",className:"pt-2"},(null===(k=this.props)||void 0===k||null===(S=k.zone.auditUsers)||void 0===S?void 0:S.length)>0?null===(C=this.props)||void 0===C||null===(U=C.zone)||void 0===U||null===(B=U.auditUsers)||void 0===B?void 0:B.map((e=>l.createElement(h.A,{bg:"info",className:"me-1 more-less-width text-truncate",key:e,title:e},e))):l.createElement("span",{className:"mt-1"},"--"))),l.createElement(d.A.Group,{as:u.A,className:"mb-3"},l.createElement(d.A.Label,{className:"text-end",column:!0,sm:"3"},"Auditor Usergroups"),l.createElement(p.A,{sm:"9",className:"pt-2"},(null===(D=this.props)||void 0===D||null===(I=D.zone)||void 0===I||null===(R=I.auditUserGroups)||void 0===R?void 0:R.length)>0?null===(M=this.props)||void 0===M||null===(G=M.zone)||void 0===G||null===(j=G.auditUserGroups)||void 0===j?void 0:j.map((e=>l.createElement(h.A,{bg:"secondary",className:"me-1 more-less-width text-truncate",key:e,title:e},e))):l.createElement("span",{className:"mt-1"},"--"))),l.createElement(d.A.Group,{as:u.A,className:"mb-3"},l.createElement(d.A.Label,{className:"text-end",column:!0,sm:"3"},"Auditor Roles"),l.createElement(p.A,{sm:"9",className:"pt-2"},(null===(L=this.props)||void 0===L||null===(O=L.zone)||void 0===O||null===(F=O.auditRoles)||void 0===F?void 0:F.length)>0?null===(H=this.props)||void 0===H||null===(K=H.zone)||void 0===K||null===(P=K.auditRoles)||void 0===P?void 0:P.map((e=>l.createElement(h.A,{bg:"primary",className:"me-1 more-less-width text-truncate",key:e,title:e},e))):l.createElement("span",{className:"mt-1"},"--")))))))),l.createElement("br",null),l.createElement("div",null,l.createElement(m.A,{defaultActiveKey:"1"},l.createElement(m.A.Item,{eventKey:"1"},l.createElement(m.A.Header,{"data-id":"panel","data-cy":"panel"},"Zone Tag Services"),l.createElement(m.A.Body,null,(null===(_=this.props)||void 0===_||null===(T=_.zone)||void 0===T||null===(V=T.tagServices)||void 0===V?void 0:V.length)>0?null==this||null===(X=this.props)||void 0===X||null===(Y=X.zone)||void 0===Y||null===(J=Y.tagServices)||void 0===J?void 0:J.map(((e,t)=>l.createElement("h6",{key:t,className:"d-inline me-1"},l.createElement(h.A,{bg:"info"},e)))):l.createElement("h6",{className:"text-muted large mt-2"},"No tag based services are associated with this zone"))))),l.createElement("br",null),l.createElement("div",null,l.createElement(m.A,{defaultActiveKey:"2"},l.createElement(m.A.Item,{eventKey:"2"},l.createElement(m.A.Header,{"data-id":"panel","data-cy":"panel"},"Services"),l.createElement(m.A.Body,null,l.createElement(v.A,{bordered:!0},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{className:"p-3 mb-2 bg-white text-dark  align-middle text-center"},"Service Name"),l.createElement("th",{className:"p-3 mb-2 bg-white text-dark align-middle text-center"},"Service Type"),l.createElement("th",{className:"p-3 mb-2 bg-white text-dark align-middle text-center"},"Resource"))),l.createElement("tbody",null,(0,E.isEmpty)(null===(q=this.props)||void 0===q||null===(Q=q.zone)||void 0===Q?void 0:Q.services)?l.createElement("tr",null,l.createElement("td",{colSpan:"3",className:"text-center text-secondary bg-light"},l.createElement("h6",{className:"text-muted large mt-2"},"No resource based services are associated with this zone"))):null===(W=Object.keys(null===($=this.props)||void 0===$||null===(ee=$.zone)||void 0===ee?void 0:ee.services))||void 0===W?void 0:W.map(((e,t)=>{var a,n,s,r,o,i,c,m=(0,E.find)(this.props.services,{name:e});return l.createElement("tr",{className:"bg-white",key:t},l.createElement("td",{className:"align-middle",width:"20%"},e),l.createElement("td",{className:"align-middle",width:"20%"},m&&m.type.toUpperCase()),l.createElement("td",{className:"text-center",width:"32%",height:"55px"},(0,E.isEmpty)(null===(a=this.props)||void 0===a||null===(n=a.zone)||void 0===n||null===(s=n.services[e])||void 0===s?void 0:s.resources)?"--":null===(r=this.props)||void 0===r||null===(o=r.zone)||void 0===o||null===(i=o.services[e])||void 0===i||null===(c=i.resources)||void 0===c?void 0:c.map(((e,t)=>{var a;return l.createElement("div",{className:"resource-group",key:t},null===(a=Object.keys(e))||void 0===a?void 0:a.map(((t,a)=>l.createElement("p",{key:a,className:"text-break"},l.createElement("strong",null,"".concat(t," : ")),e[t].join(", ")))))}))))}))))))))),l.createElement("br",null))}}const f=A;var g=a(3855),N=a(2885),y=a(5787),z=a(4699);function w(e,t,a,l,n,s,r){try{var o=e[s](r),i=o.value}catch(e){return void a(e)}o.done?t(i):Promise.resolve(i).then(l,n)}function x(e){return function(){var t=this,a=arguments;return new Promise((function(l,n){var s=e.apply(t,a);function r(e){w(s,l,n,r,o,"next",e)}function o(e){w(s,l,n,r,o,"throw",e)}r(void 0)}))}}function Z(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class k extends l.Component{constructor(e){var t;super(e),t=this,Z(this,"fetchData",x((function*(){var e,a=[],l=null,n=t.props.params.zoneId;try{a=(yield(0,r.fetchApi)({url:"zones/zones"})).data.securityZones||[]}catch(e){console.error("Error occurred while fetching Zones! ".concat(e))}try{e=yield(0,r.fetchApi)({url:"plugins/services",params:{page:0,pageSize:200,total_pages:0,startIndex:0}})}catch(e){console.error("Error occurred while fetching Services! ".concat(e))}a=(0,E.sortBy)(a,["name"]),void 0!==n?l=a.find((e=>e.id===+n))||t.props.navigate("/dataNotFound"):a.length>0&&(l=a[0],t.props.navigate("/zones/zone/".concat(a[0].id),{replace:!0})),t.setState({loader:!1,selectedZone:l,zones:a,filterZone:a,services:e.data.services})}))),Z(this,"clickBtn",(e=>{var t=this.state.zones.find((t=>e===t.id));t&&(this.setState({selectedZone:t}),this.props.navigate("/zones/zone/".concat(e)))})),Z(this,"onChangeSearch",(e=>{var t=this.state.zones.filter((t=>t.name.toLowerCase().includes(e.target.value.toLowerCase())));this.setState({filterZone:t})})),Z(this,"deleteZone",function(){var e=x((function*(e){var a=[];try{t.setState({blockUI:!0}),yield(0,r.fetchApi)({url:"zones/zones/".concat(e),method:"delete"});var l=t.state.filterZone.filter((t=>t.id!==e)),n=localStorage.getItem("zoneDetails");null!=n&&JSON.parse(n).value==e&&localStorage.removeItem("zoneDetails"),a=l.length>0?l[0]:null,t.setState({selectedZone:a,filterZone:l,zones:l,blockUI:!1}),a&&void 0!==a?t.props.navigate("/zones/zone/".concat(a.id)):t.props.navigate("/zones/zone/list"),s.oR.success("Successfully deleted the zone")}catch(a){var o,i;t.setState({blockUI:!1});var c="Error occurred while deleting Zone id - ".concat(e,"!  ").concat(a);null!=a&&null!==(o=a.response)&&void 0!==o&&null!==(i=o.data)&&void 0!==i&&i.msgDesc&&(c="Error! ".concat(a.response.data.msgDesc)),s.oR.error(c),console.error(c)}}));return function(t){return e.apply(this,arguments)}}()),Z(this,"expandBtn",(e=>{this.setState({isCollapse:!e})})),this.state={services:[],zones:[],selectedZone:null,isCollapse:!0,loader:!0,filterZone:[],isAdminRole:(0,o.FV)()||(0,o.Xm)(),blockUI:!1},this.onChangeSearch=this.onChangeSearch.bind(this)}componentDidMount(){this.fetchData()}componentDidUpdate(e){var t;void 0!==(null==e||null===(t=e.params)||void 0===t?void 0:t.zoneId)&&this.props.params.zoneId!=e.params.zoneId&&this.fetchData()}render(){return l.createElement(l.Fragment,null,l.createElement("div",{className:"header-wraper"},l.createElement("h3",{className:"wrap-header bold"},"Security Zone"),l.createElement(z.A,null)),this.state.loader?l.createElement(y.aH,null):l.createElement(l.Fragment,null,l.createElement("div",{className:"wrap"},l.createElement(u.A,null,l.createElement(y.Yh,{isUiBlock:this.state.blockUI}),l.createElement(g.A,{in:this.state.isCollapse,"data-id":"panel"},l.createElement(p.A,{sm:3,className:"border-end border-grey"},l.createElement(u.A,null,this.state.isAdminRole&&l.createElement(p.A,null,l.createElement(n.N_,{to:{pathname:"/zones/create",state:{detail:this.state.filterZone[0]}},className:"btn btn-outline-secondary btn-sm",title:"Create zone"},l.createElement("i",{className:"fa-fw fa fa-plus"}),"Create Zone"),l.createElement("hr",null))),l.createElement(u.A,null,l.createElement(p.A,null,l.createElement("input",{className:"form-control",type:"text",onChange:this.onChangeSearch,placeholder:"Search","data-id":"zoneSearch","data-cy":"zoneSearch"}))),l.createElement(u.A,null,l.createElement(p.A,null,0!==this.state.filterZone.length?l.createElement("ul",{className:"zone-listing mt-2"},this.state.filterZone.map((e=>l.createElement("li",{className:"trim-containt",key:e.id,onClick:()=>{this.clickBtn(e.id)},"data-id":e.name,"data-cy":e.name,title:e.name},l.createElement("a",{className:null!=this.state.selectedZone&&this.state.selectedZone.id===e.id?"selected":""},e.name))))):l.createElement("h6",{className:"text-muted large mt-3 bold"},"No Zone Found !"))))),l.createElement(p.A,null,null===this.state.selectedZone?l.createElement(u.A,{className:"justify-content-md-center"},l.createElement(p.A,{md:"auto"},l.createElement("div",{className:"pt-5 pr-5"},l.createElement("img",{alt:"No Zones",className:"w-50 p-3 d-block mx-auto",src:"../images/4da050c088cf839f4ea5df84bb4b6277.png"}),this.state.isAdminRole&&l.createElement(n.N_,{to:{pathname:"/zones/create",state:{detail:this.state.filterZone[0]}},className:"btn-add-security2 btn-lg text-decoration-none"},l.createElement("i",{className:"fa-fw fa fa-plus"}),"Click here to Create new Zone")))):l.createElement(f,{history:this.props.navigate,zone:this.state.selectedZone,services:this.state.services,deleteZone:this.deleteZone,expandBtn:this.expandBtn,isCollapse:this.state.isCollapse}))))))}}const S=(0,N.A)(k)}}]);