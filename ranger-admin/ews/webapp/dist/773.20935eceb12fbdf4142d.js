"use strict";(self.webpackChunkranger=self.webpackChunkranger||[]).push([[773],{7744:(e,t,a)=>{a.d(t,{A:()=>D});var l=a(6540),n=a(475),r=a(4479),c=a(1105),o=a(5615),s=a(6052),i=a(9408),u=a(1456),m=a(2543),v=a(3666),d=a(6963),p=a(6005),f=a(6696),E=a(5787);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){y(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},h.apply(this,arguments)}var N=a(1206),k="select",A="checkbox",O="input",w="radio",x="custom",S=e=>{var{options:t,value:a=[],valRef:r,showSelectAll:c,selectAllLabel:o}=e,[s,i]=(0,l.useState)(a),u=e=>-1!==(0,m.findIndex)(s,e);return l.createElement(l.Fragment,null,t.map((e=>l.createElement(n.A.Group,{className:"mb-3",controlId:e.label,key:e.label},l.createElement(n.A.Check,{checked:u(e),type:"checkbox",label:e.label,onChange:t=>((e,t)=>{var a=[...s];if(e.target.checked)a.push(t);else{var l=(0,m.findIndex)(s,t);a.splice(l,1)}r.current=a,i(a)})(t,e)})))),c&&(null==t?void 0:t.length)>1&&l.createElement(n.A.Group,{className:"mb-3",controlId:o},l.createElement(n.A.Check,{checked:s.length===t.length,type:"checkbox",label:o,onChange:e=>(e=>{var a=[];e.target.checked&&(a=[...t]),r.current=a,i(a)})(e)})))},C=e=>{var{options:t,value:a,valRef:r}=e,[c,o]=(0,l.useState)(a);return t.map((e=>l.createElement(n.A.Group,{className:"mb-3",controlId:e.label,key:e.label},l.createElement(n.A.Check,{type:"radio",value:e,label:e.label,checked:(0,v.Gv)(c)?c.value===e.value:c===e.value,onChange:t=>{return a=e,r.current=a,void o(a);var a}}))))},P=e=>{var{value:t="",valRef:a}=e,[r,c]=(0,l.useState)(t);return l.createElement(l.Fragment,null,l.createElement(n.A.Group,{className:"mb-3",controlId:"expression"},l.createElement(n.A.Control,{type:"text",defaultValue:""==r?null:r,placeholder:"enter expression",onChange:e=>(e=>{a.current=e.currentTarget.value,c(e.currentTarget.value)})(e)})))},R=e=>{var{value:t,valRef:a,conditionDefVal:o,selectProps:s,validExpression:i}=e,u=(e,t)=>{(0,v.Gv)(a.current)||(a.current={}),a.current[t]=e};return l.createElement(l.Fragment,null,(null==o?void 0:o.length)>0&&o.map((e=>{var o,b=null!=e.uiHint&&""!=e.uiHint?JSON.parse(e.uiHint):"";if(""!=b){if(null!=b&&b.singleValue){var[g,y]=(0,l.useState)((null==t?void 0:t[e.name])||t),N=[{value:"yes",label:"Yes"},{value:"no",label:"No"}],k=e=>{var t=null;if(e){var a=null==N?void 0:N.filter((t=>{var a;if(t.value==((null===(a=e[0])||void 0===a?void 0:a.value)||e))return t}));a&&(t=a)}return t};return l.createElement("div",{key:e.name},l.createElement(n.A.Group,{className:"mb-3"},l.createElement("b",null,e.label,":"),l.createElement(p.Ay,{options:N,onChange:t=>((e,t)=>{var a=null==N?void 0:N.filter((t=>{var a;if(t.value!=(null===(a=e[0])||void 0===a?void 0:a.value))return t}));y((0,m.isEmpty)(e)?null:(null==e?void 0:e.length)>1?a:e),u((0,m.isEmpty)(e)?null:(null==e?void 0:e.length)>1?a[0].value:e[0].value,t)})(t,e.name),value:null!=g&&g.value?k(g.value):k(g),isMulti:!0,isClearable:!1})))}if(null!=b&&b.isMultiline){var[A,O]=(0,l.useState)((null==t?void 0:t[e.name])||t);return l.createElement("div",{key:e.name},l.createElement(n.A.Group,{className:"mb-3"},l.createElement(r.A,null,l.createElement(c.A,null,l.createElement("b",null,e.label,":"),l.createElement(v.mo,{position:"right",message:l.createElement("p",{className:"pd-10"},f.Nz.MESSAGE.policyConditionInfoIcon)}))),l.createElement(r.A,null,l.createElement(c.A,null,l.createElement(n.A.Control,{as:"textarea",rows:3,key:e.name,value:(o=A,""!=o&&"object"!=typeof o?(a.current[e.name]=o,o):""),onChange:t=>((e,t)=>{O(e.target.value),u(e.target.value,t)})(t,e.name),isInvalid:i.state}),i.state&&l.createElement("div",{className:"text-danger"},i.errorMSG)))))}if(null!=b&&b.isMultiValue){var[w,x]=(0,l.useState)((null==t?void 0:t[e.name])||[]);return l.createElement("div",{key:e.name},l.createElement(n.A.Group,{className:"mb-3",controlId:"Ip-range",key:e.name},l.createElement("b",null,e.label,":"),l.createElement(d.A,h({},s,{defaultValue:""==w?null:w,onChange:t=>((e,t)=>{x(e),u(e,t)})(t,e.name),placeholder:"",width:"500px",isClearable:!1,styles:E.eB}))))}}})))},j=e=>{var{type:t,selectProps:a,value:l}=e,n=l;return n||t===k&&(n=null,a&&a.isMulti&&(n=[])),{value:n,target:null}};function I(e,t){switch(t.type){case"SET_VALUE":return g(g({},e),{},{value:t.value,show:t.show,target:t.target});case"SET_POPOVER":return g(g({},e),{},{show:t.show,target:t.target});default:throw new Error}}const D=e=>{var{type:t,value:a,placement:n="bottom",className:r,displayFormat:c,onChange:v,options:d=[],conditionDefVal:p,servicedefName:f}=e,E=(0,l.useRef)(!0),b=(0,l.useRef)(null),y=(0,l.useRef)(null),[h,D]=(0,l.useState)({state:!1,errorMSG:""}),[L,M]=(0,l.useReducer)(I,e,j),{show:G,value:V,target:T}=L,z=!1,_=e=>{var t;0==(null===(t=document.getElementById("popover-basic"))||void 0===t?void 0:t.contains(null==e?void 0:e.target))&&M({type:"SET_POPOVER",show:!1,target:null}),null==e||e.stopPropagation()};(0,l.useEffect)((()=>{var e;return z?()=>{var e;null===(e=document)||void 0===e||e.removeEventListener("mousedown",_)}:(null===(e=document)||void 0===e||e.addEventListener("mousedown",_),void(z=!0))}),[]),(0,l.useEffect)((()=>{E.current?E.current=!1:(v(a),M({type:"SET_VALUE",value:a,show:!1,target:null})),y.current=t===x?g({},a):a}),[a]);var K=l.createElement(i.A,{id:"popover-basic",className:"editable-popover ".concat(t===A&&"popover-maxHeight popover-minHeight")},l.createElement(i.A.Header,null,t===A?"Select":"Enter"),l.createElement(i.A.Body,null,t===A?l.createElement(S,{value:V,options:d,valRef:y,showSelectAll:e.showSelectAll,selectAllLabel:e.selectAllLabel}):t===w?l.createElement(C,{value:V,options:d,valRef:y}):t===O?l.createElement(P,{value:V,valRef:y}):t===x?l.createElement(R,{value:V,valRef:y,conditionDefVal:e.conditionDefVal,selectProps:e.selectProps,validExpression:h}):null),l.createElement("div",{className:"popover-footer-buttons"},l.createElement(o.A,{variant:"success",size:"sm",onClick:()=>{var e;null!=y&&y.current&&(0,m.sortBy)(Object.keys(y.current)).map((t=>{var a,l=(0,m.find)(p,(function(e){if(e.name==t)return e}));if(null!=l&&""!=(null==l?void 0:l.uiHint)&&null!==(a=JSON.parse(l.uiHint))&&void 0!==a&&a.isMultiline&&""!=y.current[l.name]&&null!=y.current[l.name])try{N.parseScript(y.current[l.name])}catch(t){e=t.message}})),e?D({state:!0,errorMSG:e}):(D({state:!1,errorMSG:""}),M({type:"SET_VALUE",value:y.current,show:!G,target:null}),v(y.current))},className:"me-2 btn-mini ms-2"},l.createElement("i",{className:"fa fa-fw fa-check"})),l.createElement(o.A,{className:"btn-mini",variant:"danger",size:"sm",onClick:()=>{D({state:!1,errorMSG:""}),M({type:"SET_POPOVER",show:!G,target:null})}},l.createElement("i",{className:"fa fa-fw fa-close"}))));return l.createElement("div",{ref:b},l.createElement(u.A,{show:G,target:T,trigger:"click",placement:n,overlay:K,container:b.current,rootClose:!0,rootCloseEvent:"click"},l.createElement("div",{className:"editable ".concat(r||""),onClick:e=>{D({state:!1,errorMSG:""}),M({type:"SET_POPOVER",show:!G,target:e.target})}},(()=>{var e="--",a=V;if(c)e=c(a);else if(t===k)if((null==a?void 0:a.length)>0||Object.keys(a).length>0){var n="knox"!=f||(0,m.isArray)(a)?a.map((function(e){return e.value})).join(", "):a["ip-range"];e=l.createElement("h6",{className:"d-inline me-1"},l.createElement("span",{className:"editable-edit-text badge bg-dark",style:{display:"block"}},p.name," : ",n),l.createElement(o.A,{className:"mg-10 btn-mini",variant:"outline-dark",size:"sm",type:"button"},l.createElement("i",{className:"fa-fw fa fa-pencil"})))}else e=l.createElement("div",{className:"text-center"},l.createElement("span",{className:"editable-add-text"},"Add Conditions"),l.createElement(o.A,{className:"mg-10 btn-mini",variant:"outline-dark",size:"sm",type:"button",s:!0},l.createElement("i",{className:"fa-fw fa fa-plus"})));else if(t===A)e=a&&(null==a?void 0:a.length)>0?l.createElement(l.Fragment,null,l.createElement("span",{className:"editable-edit-text"},a.map(((e,t)=>l.createElement("h6",{className:"d-inline me-1",key:t},l.createElement(s.A,{bg:"info"},e.label))))),l.createElement(o.A,{className:"mg-10 mx-auto d-block btn-mini",variant:"outline-dark",size:"sm",type:"button"},l.createElement("i",{className:"fa-fw fa fa-pencil"}))):l.createElement("div",{className:"text-center"},l.createElement("span",{className:"editable-add-text","data-js":"permissions","data-cy":"permissions"},"Add Permissions"),l.createElement(o.A,{className:"mg-10 mx-auto d-block btn-mini",variant:"outline-dark",size:"sm",type:"button",title:"add"},l.createElement("i",{className:"fa-fw fa fa-plus"})));else if(t===O)e=a&&""!==a?l.createElement(l.Fragment,null,l.createElement("span",{className:"editable-edit-text"},l.createElement("h6",{className:"d-inline me-1"},l.createElement(s.A,{bg:"info"},a))),l.createElement(o.A,{className:"mg-10 mx-auto d-block btn-mini",variant:"outline-dark",size:"sm",type:"button"},l.createElement("i",{className:"fa-fw fa fa-pencil"}))):l.createElement("div",{className:"text-center"},l.createElement("span",{className:"editable-add-text"},"Add Row Filter"),l.createElement(o.A,{className:"mg-10 mx-auto d-block btn-mini",variant:"outline-dark",size:"sm",type:"button"},l.createElement("i",{className:"fa-fw fa fa-plus"})));else if(t===w)e=a&&null!=a&&a.label?l.createElement(l.Fragment,null,l.createElement("span",{className:"editable-edit-text"},l.createElement("h6",{className:"d-inline me-1"},l.createElement(s.A,{bg:"info"},a.label))),l.createElement(o.A,{className:"mg-10 mx-auto d-block btn-mini",variant:"outline-dark",size:"sm",type:"button"},l.createElement("i",{className:"fa-fw fa fa-pencil"}))):l.createElement("div",{className:"text-center"},l.createElement("span",{className:"editable-add-text"},"Select Masking Option"),l.createElement(o.A,{className:"mg-10 mx-auto d-block  btn-mini",variant:"outline-dark",size:"sm",type:"button"},l.createElement("i",{className:"fa-fw fa fa-plus"})));else if(t===x){for(var r in a)null!=a[r]&&""!=a[r]||delete a[r];e=0!=Object.keys(a).length?l.createElement("h6",null,(()=>{var e,t;if(a)return(0,m.sortBy)(Object.keys(a)).map((n=>{var r,c,o=(0,m.find)(p,(function(e){if(e.name==n)return e}));return null!=o&&o.uiHint&&""!=(null==o?void 0:o.uiHint)&&(t=JSON.parse(o.uiHint)),(0,m.isArray)(a[n])&&(e=null===(c=a[n])||void 0===c?void 0:c.map((function(e){return e.value})).join(", ")),l.createElement("div",{key:n,className:"".concat(null!==(r=t)&&void 0!==r&&r.isMultiline?"editable-label":"badge bg-dark")},"".concat(o.label,": ").concat((0,m.isArray)(a[n])?e:a[n]))}))})(),l.createElement(o.A,{className:"mg-10 mx-auto d-block btn-mini",variant:"outline-dark",size:"sm",type:"button"},l.createElement("i",{className:"fa-fw fa fa-pencil"}))):l.createElement("div",{className:"text-center"},l.createElement("span",{className:"editable-add-text"},"Add Conditions"),l.createElement(o.A,{className:"mg-10 mx-auto d-block btn-mini",variant:"outline-dark",size:"sm",type:"button"},l.createElement("i",{className:"fa-fw fa fa-plus"})))}else e=a||"--";return e})())))}},5564:(e,t,a)=>{a.d(t,{A:()=>N});var l=a(6540),n=a(6052),r=a(5615),c=a(2465),o=a(475),s=a(2431),i=a(952),u=a(6005),m=a(924),v=a(3088),d=a(2543),p=a(1376),f=a(4283),E=a(5787);function b(){return b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},b.apply(this,arguments)}function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){h(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function h(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function N(e){var t,a,g,h,N,k,A=(0,d.cloneDeep)((0,f.Ji)()),{options:O,inputVal:w,formValues:x,serviceCompDetails:S,dataMaskIndex:C,attrName:P}=e,[R,j]=(0,l.useState)(!1),I={background:"white",color:"black"},D=y(y({},E.eB),{},{noOptionsMessage:e=>y(y({},e),I)}),L=(0,d.groupBy)(O,(function(e){var t=e.value;return t.substr(0,t.indexOf(":"))})),M=()=>{j(!1)},G=e=>{var t,a,l,n,r;return(null==x?void 0:x.policyType)==p.Kp.RANGER_MASKING_POLICY_TYPE.value?(null==e||null===(t=e.tableList)||void 0===t?void 0:t.length)>0?[]:(0,d.keys)(L).map((e=>({value:e,label:e.toUpperCase()}))):"policyItems"===P?(0,d.map)((0,d.keys)(L),(e=>({value:e,label:e.toUpperCase()}))):(n=null==S||null===(a=S.accessTypes)||void 0===a?void 0:a.filter((e=>{var t;if((0,d.includes)(null==A||null===(t=A.allServiceDefs)||void 0===t?void 0:t.map((e=>{var t;if("false"==(null==e||null===(t=e.options)||void 0===t?void 0:t.enableDenyAndExceptionsInPolicies))return e.name})).filter(Boolean),e.name.substr(0,e.name.indexOf(":"))))return e})),r=(0,d.groupBy)(n,(function(e){var t=e.name;return t.substr(0,t.indexOf(":"))})),null===(l=(0,d.difference)((0,d.keys)(L),(0,d.keys)(r)))||void 0===l?void 0:l.map((e=>({value:e,label:e.toUpperCase()}))))},V=(e,t)=>{var a=t.value||[];return-1!==(0,d.indexOf)(a,e)},T=e=>{var t=(0,d.isEmpty)(e)?[]:[...e];return!(0,d.isEmpty)(t)&&(0,d.every)(t,(e=>{var t;return(null==e||null===(t=e.permission)||void 0===t?void 0:t.length)==L[e.serviceName].length}))};return l.createElement(l.Fragment,null,l.createElement("div",{className:"editable",onClick:()=>{j(!0)}},(null==w||null===(t=w.value)||void 0===t||null===(a=t.tableList)||void 0===a?void 0:a.length)>0?l.createElement("div",{className:"text-center"},l.createElement("div",{className:"editable-edit-text"},(null==w||null===(g=w.value)||void 0===g?void 0:g.tableList).map(((e,t)=>l.createElement("h6",{className:"d-inline me-1 mb-1",key:t},l.createElement(n.A,{bg:"info"},e.serviceName.toUpperCase()))))),l.createElement(r.A,{className:"mg-10 mx-auto d-block btn-mini",size:"sm",variant:"outline-dark",onClick:e=>{e.stopPropagation(),j(!0)}},l.createElement("i",{className:"fa-fw fa fa-pencil"}))):l.createElement("div",{className:"text-center"},l.createElement("span",{className:"editable-add-text"},"Add Permissions"),l.createElement("div",null,l.createElement(r.A,{size:"sm",className:"mg-10 mx-auto d-block btn-mini",variant:"outline-dark",onClick:e=>{e.stopPropagation(),j(!0)}},l.createElement("i",{className:"fa-fw fa fa-plus"}))))),l.createElement(c.A,{show:R,onHide:M,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},l.createElement(i.lV,{onSubmit:e=>{var t=e;delete t.servicesDefType,null!=e&&e.tableList&&(t.tableList=e.tableList.filter((e=>{if(e.permission){if(!(0,d.isEmpty)(e.permission))return e;var t;e.serviceName="","tag"==(null==S?void 0:S.name)&&(null==x?void 0:x.policyType)==p.Kp.RANGER_MASKING_POLICY_TYPE.value&&null!=x&&null!==(t=x.dataMaskPolicyItems[C])&&void 0!==t&&t.dataMaskInfo&&(x.dataMaskPolicyItems[C].dataMaskInfo={})}}))),w.onChange(t),M()},initialValues:(k={},(null==w||null===(h=w.value)||void 0===h||null===(N=h.tableList)||void 0===N?void 0:N.length)>0&&(k.servicesDefType=w.value.tableList.map((e=>({label:e.serviceName.toUpperCase(),value:e.serviceName}))),k.tableList=w.value.tableList),k),mutators:y({},m.A),render:e=>{var{handleSubmit:t,form:{mutators:{push:a,remove:n}},form:m,values:f}=e;return l.createElement("form",{onSubmit:t},l.createElement(c.A.Header,{closeButton:!0},l.createElement(c.A.Title,null,"Components Permissions")),l.createElement(c.A.Body,null,l.createElement(i.D0,{name:"servicesDefType",render:e=>{var{input:t}=e;return l.createElement(o.A.Group,{className:"mb-3"},l.createElement("b",null,"Select Component:"),l.createElement(u.Ay,b({},t,{onChange:(e,l)=>((e,t,a,l,n)=>{var r,c;"select-option"==e.action?l("tableList",{serviceName:e.option.value}):(n("tableList",(0,d.findIndex)(t.value,["value",null==e||null===(r=e.removedValue)||void 0===r?void 0:r.value])),"tag"==(null==S?void 0:S.name)&&(null==x?void 0:x.policyType)==p.Kp.RANGER_MASKING_POLICY_TYPE.value&&null!=x&&null!==(c=x.dataMaskPolicyItems[C])&&void 0!==c&&c.dataMaskInfo&&(x.dataMaskPolicyItems[C].dataMaskInfo={})),t.onChange(a)})(l,t,e,a,n),isMulti:!0,options:G(f),noOptionsMessage:e=>{var{inputValue:t}=e;return(e=>(null==x?void 0:x.policyType)==p.Kp.RANGER_MASKING_POLICY_TYPE.value?e?"No results found":" You can only select 1 item":"No Options")(t)},styles:D,components:{DropdownIndicator:()=>null,IndicatorSeparator:()=>null},isClearable:!1,isSearchable:!0,placeholder:"Select Service Name"})))}}),l.createElement(s.A,{bordered:!0},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{className:"bg-white text-dark  align-middle"},l.createElement(o.A.Group,{className:"d-flex align-items-center mb-0"},l.createElement(i.D0,{name:"selectAll",type:"checkbox",render:e=>{var{input:t}=e;return l.createElement(l.Fragment,null,l.createElement("input",b({},t,{className:"me-1",checked:T(null==f?void 0:f.tableList),onChange:e=>{((e,t,a)=>{var{checked:l}=e.target,n=(0,d.cloneDeep)(null==t?void 0:t.tableList);(0,d.isEmpty)(n)||(n.filter((e=>{var t;t=L[e.serviceName].map((e=>{var{value:t}=e;return t})),e.permission=l?t:[]})),a.batch((()=>{a.change("selectAll",l),a.change("tableList",n)})))})(e,f,m)}})),"Component")}}))),l.createElement("th",{className:"bg-white text-dark align-middle"},"Permission"))),l.createElement("tbody",null,l.createElement(v.ED,{name:"tableList"},(e=>{var{fields:t}=e;return t.map(((e,a)=>{return l.createElement("tr",{className:"bg-white",key:a},l.createElement("td",{className:"align-middle td-padding-modal"},l.createElement("h6",null,l.createElement(o.A.Group,{className:"d-inline"},l.createElement(o.A.Check,{inline:!0,key:t.value[a].serviceName.toUpperCase(),checked:(n=t.value[a],r=L[t.value[a].serviceName],!(null==n||!n.permission)&&(null==n||null===(c=n.permission)||void 0===c?void 0:c.length)>0&&(null==n||null===(s=n.permission)||void 0===s?void 0:s.length)===(null==r?void 0:r.length)),type:"checkbox",label:t.value[a].serviceName.toUpperCase(),onChange:e=>((e,t,a)=>{var l=y({},a.value[t]),n=[];e.target.checked&&(n=L[l.serviceName].map((e=>{var{value:t}=e;return t}))),l.permission=n,a.update(t,l)})(e,a,t)})))),l.createElement("td",{className:"align-middle"},l.createElement(i.D0,{className:"form-control",name:"".concat(e,".permission"),render:e=>{var{input:n}=e;return l.createElement("div",null,L[t.value[a].serviceName].map((e=>l.createElement("h6",{className:"d-inline",key:e.value},l.createElement(o.A.Group,{className:"d-inline",controlId:e.value},l.createElement(o.A.Check,{inline:!0,checked:V(e.value,n),type:"checkbox",label:e.label,onChange:t=>((e,t,a)=>{var l=[...a.value]||[];if(e.target.checked)l.push(t);else{var n=(0,d.indexOf)(l,t);l.splice(n,1)}a.onChange(l)})(t,e.value,n)}))))))}})));var n,r,c,s}))}))))),l.createElement(c.A.Footer,null,l.createElement(r.A,{variant:"secondary",size:"sm",onClick:M},"Close"),l.createElement(r.A,{title:"Save",size:"sm",type:"submit"},"Save")))}})))}},9007:(e,t,a)=>{a.d(t,{A:()=>O});var l=a(6540),n=a(475),r=a(4479),c=a(1105),o=a(952),s=a(6005),i=a(239),u=a.n(i),m=a(2543),v=a(6474),d=a(6696),p=a(6963),f=a(3267),E=a(5787);function b(){return b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},b.apply(this,arguments)}function g(e,t,a,l,n,r,c){try{var o=e[r](c),s=o.value}catch(e){return void a(e)}o.done?t(s):Promise.resolve(s).then(l,n)}var y={label:"None",value:"none"};function h(e){var t,{formValues:a,grpResourcesKeys:n,levelKey:r,serviceDetails:c,name:s,isMultiResources:i}=e,[u,d]=(0,l.useState)([]),[h,N]=(0,l.useState)(!1),k=(0,l.useRef)(null),A=function(){var e,t=(e=function*(e,t,a){N(!0);var l=t.name,r=n.slice(0,n.indexOf(t.level)+1),o={};r.length>0&&r.map((function(e){var t,l;o[a["resourceName-".concat(e)].name]=(0,m.isArray)(a["value-".concat(e)])?(null===(t=a["value-".concat(e)])||void 0===t||null===(l=t.map)||void 0===l?void 0:l.call(t,(e=>{var{value:t}=e;return t})))||[]:null!=a["value-".concat(e)]?[a["value-".concat(e)].value]:[]}));var s={resourceName:l,resources:o,userInput:e||""},i=[];try{var u,p;t.lookupSupported&&(i=(null===(u=(yield(0,f.fetchApi)({url:"plugins/services/lookupResource/".concat(c.name),method:"POST",data:s})).data)||void 0===u||null===(p=u.map)||void 0===p?void 0:p.call(u,(e=>({label:e,value:e}))))||[])}catch(e){var E,b;N(!1),v.oR.dismiss(k.current),null!=e&&null!==(E=e.response)&&void 0!==E&&null!==(b=E.data)&&void 0!==b&&b.msgDesc?k.current=v.oR.error(e.response.data.msgDesc):k.current=v.oR.error("Resouce lookup failed for current resource")}d(i),N(!1)},function(){var t=this,a=arguments;return new Promise((function(l,n){var r=e.apply(t,a);function c(e){g(r,l,n,c,o,"next",e)}function o(e){g(r,l,n,c,o,"throw",e)}c(void 0)}))});return function(e,a,l){return t.apply(this,arguments)}}(),O=(0,l.useRef)((0,m.debounce)(A,1e3)),w=(e,t)=>(t.trim().toLowerCase(),!0);return l.createElement(o.D0,{key:a["resourceName-".concat(r)].name,className:"form-control",name:i?"".concat(s,".value-").concat(r):"value-".concat(r),validate:a&&(null===(t=a["resourceName-".concat(r)])||void 0===t?void 0:t.mandatory)&&(e=>((e,t)=>{if(!e||0==e.length)return"Required";if(null!=t&&t.validationRegEx&&(null==e?void 0:e.length)>0){var a=new RegExp(t.validationRegEx);if("^\\*$"==t.validationRegEx&&0==a.test(e[e.length-1].value))return'Only "*" value is allowed';if("^[/*]$|^/.*?[^/]$"==t.validationRegEx&&0==a.test(e[e.length-1].value))return"Relative Path start with slash and must not end with a slash"}})(e,a["resourceName-".concat(r)])),render:e=>{var t,n,c,{input:o,meta:m}=e;return l.createElement(l.Fragment,null,l.createElement(p.A,b({},o,{id:a&&null!==(t=a["resourceName-".concat(r)])&&void 0!==t&&t.mandatory&&m.error?"isError":i?"".concat(s,".value-").concat(r):"value-".concat(r),isMulti:(c=a["resourceName-".concat(r)],null==c||!c.uiHint||!JSON.parse(c.uiHint).singleValue),isClearable:!0,isDisabled:a["resourceName-".concat(r)].value===y.value,options:u,onFocus:e=>{e.stopPropagation(),d([]),A("",a["resourceName-".concat(r)],a)},onInputChange:(e,t)=>{((e,t,a,l)=>{var{action:n}=l;"input-change"!==n||null!=e&&(N(!0),d([]),O.current(e,t,a))})(e,a["resourceName-".concat(r)],a,t)},filterOption:w,isLoading:h,styles:E.eB})),a&&(null===(n=a["resourceName-".concat(r)])||void 0===n?void 0:n.mandatory)&&m.touched&&m.error&&l.createElement("span",{className:"invalid-field"},m.error))}})}var N=a(3666);function k(){return k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},k.apply(this,arguments)}var A={label:"None",value:"none"};function O(e){var{serviceCompDetails:t,formValues:a,serviceDetails:i,policyType:p,policyId:f,name:b,isMultiResources:g}=e,[y,O]=(0,l.useState)({loader:!1,resourceKey:-1}),w=(0,l.useRef)(null),x=(0,N._b)(t,p);(0,l.useEffect)((()=>{y.loader&&O({loader:!1,resourceKey:-1})}),[y.loader]);var S=(0,m.groupBy)(x,"level"),C=[];for(var P in S)C.push(+P);C=C.sort();var R=(e,t)=>{var l=S[e];if(0!==t){var n=C[t-1],r="resourceName-".concat(n);a&&a[r]&&(l=(0,m.filter)(S[e],{parent:a[r].name}),a[r].isValidLeaf&&l.push(A))}return l},j=e=>{var t,{name:n}=e;return a&&(null===(t=a[n])||void 0===t?void 0:t.mandatory)&&l.createElement("span",null,"*")||l.createElement("span",null," ")};return C.map(((e,t)=>{var p="resourceName-".concat(e);if(0!==t){var N=((e,t)=>{var l=C[t-1],n="resourceName-".concat(l),r=!1;return a&&a[n]&&(r=(0,m.some)(S[e],{parent:a[n].name})),r})(e,t);if(!N)return null}return y.loader&&y.resourceKey<e?null:l.createElement(n.A.Group,{as:r.A,className:"mb-3",controlId:"Resource-".concat(e),key:"Resource-".concat(e)},l.createElement(c.A,{sm:3},l.createElement(o.D0,{defaultValue:!f&&R(e,t)[0],name:g?"".concat(b,".resourceName-").concat(e):"resourceName-".concat(e),render:r=>{var{input:c}=r;return a[p]?((e,t)=>{var l,n,r=!1,c="resourceName-".concat(e),o=S[e];if(0!==t&&(o=R(e,t)),1===o.length&&!(null!==(l=a[c])&&void 0!==l&&null!==(n=l.parent)&&void 0!==n&&n.length)>0)r=!0;else if(0!==t){var s=C[t-1],i="resourceName-".concat(s);1!==(0,m.filter)(o,{parent:a[i].name}).length||a[i].isValidLeaf||(r=!0)}return r})(e,t)?l.createElement("span",{className:"float-end fnt-14"},l.createElement(n.A.Label,{className:"position-relative pe-2"},R(e,t)[0].label,l.createElement(j,{name:"resourceName-".concat(e)}))):l.createElement("div",{className:"resource-drop-down"},l.createElement("span",{className:"w-75"},l.createElement(s.Ay,k({},c,{options:R(e,t),getOptionLabel:e=>e.label,getOptionValue:e=>e.name,onChange:e=>((e,t,l)=>{for(var n=l;n<C.length;n++){var r=C[n];delete a["resourceName-".concat(r)],delete a["value-".concat(r)],delete a["isExcludesSupport-".concat(r)],delete a["isRecursiveSupport-".concat(r)]}delete a["value-".concat(C[l])];for(var c=e.name,o=l+1;o<C.length;o++){var s=C[o],i=x.find((e=>{if(null!=e&&e.parent)return e.parent===c}));i&&(a["resourceName-".concat(s)]=i,c=i.name)}"udf"===(null==e?void 0:e.name)&&"database"===(null==e?void 0:e.parent)&&(v.oR.dismiss(w.current),w.current=v.oR.warning((0,d.oG)())),t.onChange(e),O({loader:!0,resourceKey:C[l]})})(e,c,t),isSearchable:!1,styles:E.eB}))),l.createElement(j,{name:"resourceName-".concat(e)})):null}})),a["resourceName-".concat(e)]&&l.createElement(l.Fragment,null,l.createElement(c.A,{sm:5},l.createElement(h,{levelKey:e,formValues:a,grpResourcesKeys:C,serviceDetails:i,name:b,isMultiResources:g}))),a["resourceName-".concat(e)]&&l.createElement(c.A,{sm:4},l.createElement(r.A,null,a["resourceName-".concat(e)].excludesSupported&&l.createElement(c.A,{sm:5},l.createElement(o.D0,{className:"form-control",name:g?"".concat(b,".isExcludesSupport-").concat(e):"isExcludesSupport-".concat(e),render:t=>{var{input:a}=t;return l.createElement(u(),k({},a,{checked:!(!1===a.value),onlabel:"Include",onstyle:"primary",offlabel:"Exclude",offstyle:"outline-secondary",style:"w-100",size:"xs",key:"isExcludesSupport-".concat(e)}))}})),a["resourceName-".concat(e)].recursiveSupported&&l.createElement(c.A,{sm:5,className:"toggle-switch"},l.createElement(o.D0,{className:"form-control",name:g?"".concat(b,".isRecursiveSupport-").concat(e):"isRecursiveSupport-".concat(e),render:t=>{var{input:a}=t;return l.createElement(u(),k({},a,{checked:!(!1===a.value),onlabel:"Recursive",onstyle:"primary",width:130,offlabel:"Non-recursive",offstyle:"outline-secondary",size:"xs",key:"isRecursiveSupport-".concat(e)}))}})))))}))}}}]);