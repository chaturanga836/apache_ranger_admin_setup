"use strict";(self.webpackChunkranger=self.webpackChunkranger||[]).push([[764],{1764:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var l=a(6540),r=a(8106),n=a(8651),i=a(4479),c=a(1105),o=a(9423),s=a(5787),u=a(4743),m=a.n(u),p=a(3666),d=a(8281),f=a(3267),v=a(2543),g=a(4283),y=a(6696),b=a(1376);function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function T(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function w(e,t,a,l,r,n,i){try{var c=e[n](i),o=c.value}catch(e){return void a(e)}c.done?t(o):Promise.resolve(o).then(l,r)}const N=function(){var e=(0,r.KC)(),t=e.services,a=e.servicesAvailable,[u,N]=(0,l.useState)([]),[h,S]=(0,l.useState)(!0),[P,O]=(0,l.useState)([]),[C,x]=(0,l.useState)(m().now()),D=(0,l.useRef)(0),[H,A]=(0,l.useState)(!0),[I,U]=(0,l.useState)([]),[j,k]=(0,n.ok)(),[L,M]=(0,l.useState)([]),[W,F]=(0,l.useState)({page:null}),J=(0,p.Xm)()||(0,p.EH)(),{allServiceDefs:V}=(0,v.cloneDeep)((0,g.Ji)()),[z,B]=l.useState(0);(0,l.useEffect)((()=>{if(null!==a){var{searchFilterParam:e,defaultSearchFilterParam:t,searchParam:l}=(0,p.r8)("pluginStatus",j,_);k(l,{replace:!0}),JSON.stringify(I)!==JSON.stringify(e)&&U(e),M(t),localStorage.setItem("pluginStatus",JSON.stringify(l)),A(!1)}}),[j,a]);var K=(0,l.useCallback)(function(){var e,t=(e=function*(e){var{pageSize:t,pageIndex:l,gotoPage:r}=e;if(S(!0),null!==a){var n=[],i=[],c=0,o=++D.current,s=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){T(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},I);if(o===D.current){s.pageSize=t,s.startIndex=l*t;try{i=(n=yield(0,f.fetchApi)({url:"plugins/plugins/info",params:s})).data.pluginInfoList,c=n.data.totalCount}catch(e){(0,p.ig)(e),console.error("Error occurred while fetching Plugin Status logs! ".concat(e))}N(i),O(n.data),B(Math.ceil(c/t)),F({page:r}),S(!1)}}},function(){var t=this,a=arguments;return new Promise((function(l,r){var n=e.apply(t,a);function i(e){w(n,l,r,i,c,"next",e)}function c(e){w(n,l,r,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),[C,I,a]),R=(e,t)=>(e-t)/36e5<0,X=e=>(0,v.isUndefined)(e)||(0,v.isNull)(e)?l.createElement("center",null,"--"):(0,p.bd)(e),Z=(e,t,a)=>{if((0,v.isUndefined)(e)||(0,v.isNull)(e))return l.createElement("center",null,"--");if(!(0,v.isUndefined)(t)){var r=new Date(parseInt(e)),n=new Date(parseInt(t));if(R(r,n))return m()(r).diff(m()(n),"minutes")>=-2?l.createElement("span",{className:"text-warning"},l.createElement(s.VO,{placement:"bottom",content:b.t5[a].downloadTimeDelayMsg,icon:"fa-fw fa fa-exclamation-circle active-policy-alert"}),(0,p.bd)(e)):l.createElement("span",{className:"text-error"},l.createElement(s.VO,{placement:"bottom",content:b.t5[a].downloadTimeDelayMsg,icon:"fa-fw fa fa-exclamation-circle active-policy-alert"}),(0,p.bd)(e)," ")}return(0,p.bd)(e)},q=(e,t,a)=>{if((0,v.isUndefined)(e)||(0,v.isNull)(e)||0==e)return l.createElement("center",null,"--");if(!(0,v.isUndefined)(t)){var r=new Date(parseInt(e)),n=new Date(parseInt(t));if(R(r,n))return m()(r).diff(m()(n),"minutes")>=-2?l.createElement("span",{className:"text-warning"},l.createElement(s.VO,{placement:"bottom",content:b.t5[a].activationTimeDelayMsg,icon:"fa-fw fa fa-exclamation-circle active-policy-alert"}),(0,p.bd)(e)):l.createElement("span",{className:"text-error"},l.createElement(s.VO,{placement:"bottom",content:b.t5[a].activationTimeDelayMsg,icon:"fa-fw fa fa-exclamation-circle active-policy-alert"}),(0,p.bd)(e))}return(0,p.bd)(e)},G=e=>l.createElement(l.Fragment,null,l.createElement("b",null,e," ( Time )"),l.createElement(s.tZ,{icon:"fa-fw fa fa-info-circle info-icon",title:b.t5[e].title,content:(0,y.Cz)(e),placement:"left",trigger:["hover","focus"]})),Q=(e,t,a)=>{var l,r,n,i,c=new Date(parseInt(null!==(l=null===(r=e.original)||void 0===r?void 0:r.info[a])&&void 0!==l?l:0)),o=new Date(parseInt(null!==(n=null===(i=t.original)||void 0===i?void 0:i.info[a])&&void 0!==n?n:0));return c<o?-1:c>o?1:void 0},Y=(e,t,a)=>{var l,r,n,i;if(1!=((null!==(l=(0,v.get)(e.original,a))&&void 0!==l?l:"")===(null!==(r=(0,v.get)(t.original,a))&&void 0!==r?r:"")))return(null!==(n=(0,v.get)(e.original,a))&&void 0!==n?n:"").localeCompare(null!==(i=(0,v.get)(t.original,a))&&void 0!==i?i:"")},$=l.useMemo((()=>[{Header:"Service Name",accessor:"serviceDisplayName",sortType:(e,t,a)=>Y(e,t,a),Cell:e=>l.createElement("div",{className:"text-truncate"},l.createElement("span",{title:e.value},(0,v.isEmpty)(e.value)?l.createElement("center",null,"--"):e.value))},{Header:"Service Type",accessor:"serviceType",sortType:(e,t,a)=>Y(e,t,a),Cell:e=>l.createElement("div",{className:"text-truncate"},l.createElement("span",{title:e.value},(0,v.isEmpty)(e.value)?l.createElement("center",null,"--"):e.value))},{Header:"Application",accessor:"appType",sortType:(e,t,a)=>Y(e,t,a),Cell:e=>l.createElement("div",{className:"text-truncate"},l.createElement("span",{title:e.value},(0,v.isEmpty)(e.value)?l.createElement("center",null,"--"):e.value))},{Header:"Host Name",accessor:"hostName",sortType:(e,t,a)=>Y(e,t,a),Cell:e=>l.createElement("div",{className:"text-truncate"},l.createElement("span",{title:e.value},(0,v.isEmpty)(e.value)?l.createElement("center",null,"--"):e.value))},{Header:"Plugin IP",accessor:"ipAddress",sortType:(e,t,a)=>Y(e,t,a),Cell:e=>l.createElement("div",{className:"text-truncate"},l.createElement("span",{title:e.value},(0,v.isEmpty)(e.value)?l.createElement("center",null,"--"):e.value))},{Header:"Cluster Name",accessor:"info.clusterName",sortType:(e,t,a)=>Y(e,t,a),Cell:e=>l.createElement("div",{className:"text-truncate"},l.createElement("span",{title:e.value},(0,v.isEmpty)(e.value)?l.createElement("center",null,"--"):e.value))},{Header:G("Policy"),id:"Policy (Time)",columns:[{Header:"Last Update",accessor:"lastPolicyUpdateTime",sortType:(e,t,a)=>Q(e,t,a),Cell:e=>{var{row:{original:t}}=e;return X(t.info.lastPolicyUpdateTime)},minWidth:190},{Header:"Download",accessor:"policyDownloadTime",sortType:(e,t,a)=>Q(e,t,a),Cell:e=>{var{row:{original:t}}=e;return Z(t.info.policyDownloadTime,t.info.lastPolicyUpdateTime,"Policy")},minWidth:190},{Header:"Active",accessor:"policyActivationTime",sortType:(e,t,a)=>Q(e,t,a),Cell:e=>{var{row:{original:t}}=e;return q(t.info.policyActivationTime,t.info.lastPolicyUpdateTime,"Policy")},minWidth:190}]},{Header:G("Tag"),id:"Tag (Time)",columns:[{Header:"Last Update",accessor:"lastTagUpdateTime",sortType:(e,t,a)=>Q(e,t,a),Cell:e=>{var{row:{original:t}}=e;return X(t.info.lastTagUpdateTime)},minWidth:190},{Header:"Download",accessor:"tagDownloadTime",sortType:(e,t,a)=>Q(e,t,a),Cell:e=>{var{row:{original:t}}=e;return Z(t.info.tagDownloadTime,t.info.lastTagUpdateTime,"Tag")},minWidth:190},{Header:"Active",accessor:"tagActivationTime",sortType:(e,t,a)=>Q(e,t,a),Cell:e=>{var{row:{original:t}}=e;return q(t.info.tagActivationTime,t.info.lastTagUpdateTime,"Tag")},minWidth:190}]}]),[]),_=[{category:"pluginAppType",label:"Application",urlLabel:"applicationType",type:"text"},{category:"clusterName",label:"Cluster Name",urlLabel:"clusterName",type:"text"},{category:"pluginHostName",label:"Host Name",urlLabel:"hostName",type:"text"},{category:"pluginIpAddress",label:"Plugin IP",urlLabel:"agentIp",type:"text"},{category:"serviceName",label:"Service Name",urlLabel:"serviceName",type:"textoptions",options:()=>{var e,a;return a=(0,v.filter)(t,(function(e){return J?"tag"!==e.type:"tag"!==e.type&&"kms"!==e.type})),null===(e=(0,v.sortBy)(a,"name"))||void 0===e?void 0:e.map((e=>({label:e.displayName,value:e.name})))}},{category:"serviceType",label:"Service Type",urlLabel:"serviceType",type:"textoptions",options:()=>(0,v.map)(V,(function(e){return{label:(0,v.toUpper)(e.displayName),value:e.name}}))}];return H?l.createElement(s.aH,null):l.createElement("div",{className:"wrap"},l.createElement(l.Fragment,null,l.createElement(i.A,{className:"mb-2"},l.createElement(c.A,{sm:12},l.createElement("div",{className:"searchbox-border"},l.createElement(d.A,{key:"plugin-status-log-search-filter",placeholder:"Search for your plugin status...",options:(0,v.sortBy)(_,["label"]),onChange:e=>{var{searchFilterParam:t,searchParam:a}=(0,p.kI)(e,_);U(t),k(a,{replace:!0}),localStorage.setItem("pluginStatus",JSON.stringify(a)),"function"==typeof(null==W?void 0:W.page)&&W.page(0)},defaultSelected:L})))),l.createElement("div",{className:"position-relative"},l.createElement(i.A,null,l.createElement(c.A,{sm:11},l.createElement(s.IU,{entries:P,refreshTable:()=>{N([]),S(!0),x(m().now())}}))),l.createElement(o.A,{data:u,columns:$,loading:h,totalCount:P&&P.totalCount,fetchData:K,columnSort:!0,clientSideSorting:!0,pageCount:z,columnHide:{tableName:"pluginStatus",isVisible:!0}}))))}}}]);